<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>libics.tools.math &mdash; libics 1.0a documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="libics.tools.plot" href="libics.tools.plot.html" />
    <link rel="prev" title="libics.tools.database" href="libics.tools.database.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> libics
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="libics.env.html">libics.env</a></li>
<li class="toctree-l1"><a class="reference internal" href="libics.core.html">libics.core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="libics.tools.html">libics.tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="libics.tools.control.html">libics.tools.control</a></li>
<li class="toctree-l2"><a class="reference internal" href="libics.tools.database.html">libics.tools.database</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">libics.tools.math</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.models">models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.flat">flat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.peaked">peaked</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.intervalfunc">intervalfunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.calculus">calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.sampling">sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.signal">signal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-libics.tools.math.tensor">tensor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="libics.tools.plot.html">libics.tools.plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="libics.tools.trafo.html">libics.tools.trafo</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">libics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="libics.tools.html">libics.tools</a> &raquo;</li>
      <li>libics.tools.math</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_dynamic/libics.tools.math.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-libics.tools.math">
<span id="libics-tools-math"></span><h1>libics.tools.math<a class="headerlink" href="#module-libics.tools.math" title="Permalink to this headline"></a></h1>
<section id="module-libics.tools.math.models">
<span id="models"></span><h2>models<a class="headerlink" href="#module-libics.tools.math.models" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.models.</span></span><span class="sig-name descname"><span class="pre">ModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for functional models.</p>
<ul class="simple">
<li><p>Supports fitting.</p></li>
<li><p>For convenience, fitting can be directly applied by passing the data
to the constructor.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>const_p0</strong><span class="classifier"><cite>dict(str-&gt;float)</cite></span></dt><dd><p>Not fitted parameters set to the given value.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For subclassing, implement the following attributes and methods:</p>
<ul class="simple">
<li><p><cite>P_ALL</cite> : <cite>Iterable[str]</cite>, e.g. <cite>[“x0”, “y0”, “z0”]</cite>.
Ordered (w.r.t model function) list of parameter names (will be used to
access parameters). Class attribute.</p></li>
<li><p><cite>P_DEFAULT</cite> : <cite>Iterable[float]</cite>.
Default <cite>p0</cite> parameters.</p></li>
<li><p><cite>_func</cite> : <cite>Callable[var, *param]</cite>.
Model function. Static method.</p></li>
<li><p><cite>find_p0</cite> : <cite>Callable[*data]</cite>.
Automatized initial parameter finding routine. The argument <cite>*data</cite>
should be interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>. Optional method.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Assumes a concrete model class (i.e. subclass of this base class).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">ModelBase</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">P_ALL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x0&quot;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">P_DEFAULT</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_func</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">var</span> <span class="o">+</span> <span class="n">x0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">pfit</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x0&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_data</span><span class="p">,</span> <span class="n">func_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">find_popt</span><span class="p">(</span><span class="n">var_data</span><span class="p">,</span> <span class="n">func_data</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">popt</span>
<span class="go">array([2.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">pstd</span>
<span class="go">array([0.013333333])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">x0</span>
<span class="go">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">x0_std</span>
<span class="go">0.013333333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;x0&quot;</span><span class="p">]</span>
<span class="go">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;x0_std&quot;</span><span class="p">]</span>
<span class="go">0.013333333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">(</span><span class="n">var_data</span><span class="p">)</span>
<span class="go">array([2., 3., 4.])</span>
</pre></div>
</div>
<p>A direct fit is applied as:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">var_data</span><span class="p">,</span> <span class="n">func_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">psuccess</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></a></dt><dd><p>All <a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a></p>
</dd>
<dt><a class="reference internal" href="#libics.tools.math.models.ModelBase.p0_for_fit" title="libics.tools.math.models.ModelBase.p0_for_fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></a></dt><dd><p>Fitted <a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a></p>
</dd>
<dt><a class="reference internal" href="#libics.tools.math.models.ModelBase.pall" title="libics.tools.math.models.ModelBase.pall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></a></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><a class="reference internal" href="#libics.tools.math.models.ModelBase.pfit" title="libics.tools.math.models.ModelBase.pfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></a></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><a class="reference internal" href="#libics.tools.math.models.ModelBase.popt" title="libics.tools.math.models.ModelBase.popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></a></dt><dd><p>All <a class="reference internal" href="#libics.tools.math.models.ModelBase.popt" title="libics.tools.math.models.ModelBase.popt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></a> (non-fitted ones use <a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a>)</p>
</dd>
<dt><a class="reference internal" href="#libics.tools.math.models.ModelBase.popt_for_fit" title="libics.tools.math.models.ModelBase.popt_for_fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></a></dt><dd><p>Fitted <a class="reference internal" href="#libics.tools.math.models.ModelBase.popt" title="libics.tools.math.models.ModelBase.popt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></a></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.find_chi2" title="libics.tools.math.models.ModelBase.find_chi2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code></a>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.find_chi2_red" title="libics.tools.math.models.ModelBase.find_chi2_red"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code></a>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.find_chi2_significance" title="libics.tools.math.models.ModelBase.find_chi2_significance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code></a>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.find_p0" title="libics.tools.math.models.ModelBase.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>()</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.find_popt" title="libics.tools.math.models.ModelBase.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.get_model_data" title="libics.tools.math.models.ModelBase.get_model_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code></a>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.set_p0" title="libics.tools.math.models.ModelBase.set_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code></a>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.set_pfit" title="libics.tools.math.models.ModelBase.set_pfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code></a>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.models.ModelBase.test_hypothesis_chi2" title="libics.tools.math.models.ModelBase.test_hypothesis_chi2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code></a>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.models.ModelBase</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.models.ModelBase.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#libics.tools.math.models.ModelBase.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#libics.tools.math.models.ModelBase.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.find_chi2">
<span class="sig-name descname"><span class="pre">find_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.find_chi2" title="Permalink to this definition"></a></dt>
<dd><p>Gets the chi squared statistic.</p>
<p>This is the sum of the squared residuals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.find_chi2_red">
<span class="sig-name descname"><span class="pre">find_chi2_red</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.find_chi2_red" title="Permalink to this definition"></a></dt>
<dd><p>Gets the reduced chi squared statistic.</p>
<p>This is the sum of the squared residuals divided by the degrees of
freedom (data points minus number of fit parameters).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.find_chi2_significance">
<span class="sig-name descname"><span class="pre">find_chi2_significance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.find_chi2_significance" title="Permalink to this definition"></a></dt>
<dd><p>Gets the chi squared confindence quantile for the fit.</p>
<p>Example: For a 2-sigma-quality fit, <cite>0.95</cite> is returned.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.get_model_data">
<span class="sig-name descname"><span class="pre">get_model_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.get_model_data" title="Permalink to this definition"></a></dt>
<dd><p>Gets a (continuos) model data array using fitted parameters.</p>
<p>Generates a continuos meshgrid spanning the domain of the data points
used for fitting. Calls the model function using the optimized
fit parameters for this meshgrid.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>shape</strong><span class="classifier"><cite>Iter[int]</cite> or <cite>int</cite></span></dt><dd><p>Shape of meshgrid. If <cite>int</cite>, uses the same size in all dimensions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>data_cont</strong><span class="classifier"><cite>ArrayData(float)</cite></span></dt><dd><p>Continuos model data.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If no prior fit has been performed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.get_p0">
<span class="sig-name descname"><span class="pre">get_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.get_p0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.get_popt">
<span class="sig-name descname"><span class="pre">get_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.get_popt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.get_pstd">
<span class="sig-name descname"><span class="pre">get_pstd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.get_pstd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.p0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p0</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.p0" title="Permalink to this definition"></a></dt>
<dd><p>All <a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.p0_for_fit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p0_for_fit</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.p0_for_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fitted <a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.p0_is_set">
<span class="sig-name descname"><span class="pre">p0_is_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.p0_is_set" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.pall">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pall</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.pall" title="Permalink to this definition"></a></dt>
<dd><p>dict(name-&gt;index) for all parameters</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.pcov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pcov</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.pcov" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.pcov_for_fit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pcov_for_fit</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.pcov_for_fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.pfit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pfit</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.pfit" title="Permalink to this definition"></a></dt>
<dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.popt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">popt</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.popt" title="Permalink to this definition"></a></dt>
<dd><p>All <a class="reference internal" href="#libics.tools.math.models.ModelBase.popt" title="libics.tools.math.models.ModelBase.popt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></a> (non-fitted ones use <a class="reference internal" href="#libics.tools.math.models.ModelBase.p0" title="libics.tools.math.models.ModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.popt_for_fit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">popt_for_fit</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.popt_for_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fitted <a class="reference internal" href="#libics.tools.math.models.ModelBase.popt" title="libics.tools.math.models.ModelBase.popt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.pstd">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pstd</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.pstd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.pstd_for_fit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pstd_for_fit</span></span><a class="headerlink" href="#libics.tools.math.models.ModelBase.pstd_for_fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.set_p0">
<span class="sig-name descname"><span class="pre">set_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">p0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.set_p0" title="Permalink to this definition"></a></dt>
<dd><p>Sets initial parameters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>**p0</strong><span class="classifier"><cite>str-&gt;float</cite></span></dt><dd><p>Initial parameter name-&gt;value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.set_pfit">
<span class="sig-name descname"><span class="pre">set_pfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">const_p0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.set_pfit" title="Permalink to this definition"></a></dt>
<dd><p>Set which parameters to fit.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*opt</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>Names of fit parameters to be optimized.
If any <cite>opt</cite> is given, <cite>const</cite> and <cite>const_p0</cite> will be ignored.</p>
</dd>
<dt><strong>const</strong><span class="classifier"><cite>Iter[str]</cite></span></dt><dd><p>Names of parameters not to be fitted.</p>
</dd>
<dt><strong>**const_p0</strong><span class="classifier"><cite>str-&gt;float</cite></span></dt><dd><p>Same as <cite>const</cite>, <cite>float</cite> arguments are used to fix the
constant parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.split_fit_data">
<span class="sig-name descname"><span class="pre">split_fit_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.split_fit_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.ModelBase.test_hypothesis_chi2">
<span class="sig-name descname"><span class="pre">test_hypothesis_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.ModelBase.test_hypothesis_chi2" title="Permalink to this definition"></a></dt>
<dd><p>Tests the whether the fit is valid.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>p_value</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Critical confidence level (“alpha-value”),
e.g. <cite>0.05</cite> for 2-sigma.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.models.</span></span><span class="sig-name descname"><span class="pre">TensorModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>p0</strong></dt><dd></dd>
<dt><a class="reference internal" href="#libics.tools.math.models.TensorModelBase.pall_scal" title="libics.tools.math.models.TensorModelBase.pall_scal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall_scal</span></code></a></dt><dd><p>dict(name-&gt;index) for scalar parameters</p>
</dd>
<dt><a class="reference internal" href="#libics.tools.math.models.TensorModelBase.pall_vect" title="libics.tools.math.models.TensorModelBase.pall_vect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall_vect</span></code></a></dt><dd><p>dict(name-&gt;index) for vector parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><a class="reference internal" href="#libics.tools.math.models.TensorModelBase.popt" title="libics.tools.math.models.TensorModelBase.popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></a></dt><dd><p>All <a class="reference internal" href="#libics.tools.math.models.TensorModelBase.popt" title="libics.tools.math.models.TensorModelBase.popt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></a> (non-fitted ones use <a class="reference internal" href="#libics.tools.math.models.TensorModelBase.p0" title="libics.tools.math.models.TensorModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a>)</p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.models.TensorModelBase.find_p0" title="libics.tools.math.models.TensorModelBase.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>()</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.models.TensorModelBase.find_popt" title="libics.tools.math.models.TensorModelBase.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 60%" />
<col style="width: 40%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>popt_is_set</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.models.TensorModelBase</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.P_SCAL">
<span class="sig-name descname"><span class="pre">P_SCAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.P_SCAL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.P_TENS">
<span class="sig-name descname"><span class="pre">P_TENS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ptens'</span></em><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.P_TENS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.P_VECT">
<span class="sig-name descname"><span class="pre">P_VECT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.P_VECT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.get_popt">
<span class="sig-name descname"><span class="pre">get_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.get_popt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.p0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p0</span></span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.p0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.p0_is_set">
<span class="sig-name descname"><span class="pre">p0_is_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.p0_is_set" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.pall_scal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pall_scal</span></span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.pall_scal" title="Permalink to this definition"></a></dt>
<dd><p>dict(name-&gt;index) for scalar parameters</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.pall_vect">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pall_vect</span></span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.pall_vect" title="Permalink to this definition"></a></dt>
<dd><p>dict(name-&gt;index) for vector parameters</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.pcov">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pcov</span></span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.pcov" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.popt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">popt</span></span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.popt" title="Permalink to this definition"></a></dt>
<dd><p>All <a class="reference internal" href="#libics.tools.math.models.TensorModelBase.popt" title="libics.tools.math.models.TensorModelBase.popt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></a> (non-fitted ones use <a class="reference internal" href="#libics.tools.math.models.TensorModelBase.p0" title="libics.tools.math.models.TensorModelBase.p0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></a>)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.popt_is_set">
<span class="sig-name descname"><span class="pre">popt_is_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.popt_is_set" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.models.TensorModelBase.pstd">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pstd</span></span><a class="headerlink" href="#libics.tools.math.models.TensorModelBase.pstd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-libics.tools.math.flat">
<span id="flat"></span><h2>flat<a class="headerlink" href="#module-libics.tools.math.flat" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitCosine1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitCosine1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.cosine_1d" title="libics.tools.math.flat.cosine_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">cosine_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>f</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>frequency without 2π</p>
</dd>
<dt><strong>phi</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>additive phase</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitCosine1d.find_p0" title="libics.tools.math.flat.FitCosine1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data[, MAX_POINTS])</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitCosine1d.find_popt" title="libics.tools.math.flat.FitCosine1d.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitLinear1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitCosine1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'f',</span> <span class="pre">'phi',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitCosine1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitCosine1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAX_POINTS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitCosine1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine1d.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitCosine1d.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitCosine2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.cosine_2d" title="libics.tools.math.flat.cosine_2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">cosine_2d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>fx, fy</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>frequency without 2π</p>
</dd>
<dt><strong>phi</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>additive phase</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>f</strong></dt><dd><p>Vectorial frequency (fx, fy)</p>
</dd>
<dt><strong>angle</strong></dt><dd><p>Frequency angle arctan(fy/fx)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitCosine2d.find_p0" title="libics.tools.math.flat.FitCosine2d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data[, MAX_LINES, MAX_POINTS])</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitCosine2d.find_popt" title="libics.tools.math.flat.FitCosine2d.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitCosine2d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'fx',</span> <span class="pre">'fy',</span> <span class="pre">'phi',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.angle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angle</span></span><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.angle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.angle_std">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angle_std</span></span><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.angle_std" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.f">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">f</span></span><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.f" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAX_LINES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAX_POINTS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitCosine2d.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitCosine2d.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitErrorFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitErrorFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitErrorFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.error_function" title="libics.tools.math.flat.error_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">error_function()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>w</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitErrorFunction.find_p0" title="libics.tools.math.flat.FitErrorFunction.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitErrorFunction.find_popt" title="libics.tools.math.flat.FitErrorFunction.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitErrorFunction.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitErrorFunction</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitErrorFunction.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitErrorFunction.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'w',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitErrorFunction.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitErrorFunction.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitErrorFunction.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitErrorFunction.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitErrorFunction.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitErrorFunction.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitErrorFunction.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinear1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitLinear1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitLinear1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.linear_1d" title="libics.tools.math.flat.linear_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">linear_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitLinear1d.find_p0" title="libics.tools.math.flat.FitLinear1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitLinear1d.find_popt" title="libics.tools.math.flat.FitLinear1d.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinear1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitLinear1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitLinear1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinear1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitLinear1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinear1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitLinear1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinear1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitLinear1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinear1d.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitLinear1d.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinearStepFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitLinearStepFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitLinearStepFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.linear_step_function" title="libics.tools.math.flat.linear_step_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">linear_step_function()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>w</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitLinearStepFunction.find_p0" title="libics.tools.math.flat.FitLinearStepFunction.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitLinearStepFunction.find_popt" title="libics.tools.math.flat.FitLinearStepFunction.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinearStepFunction.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitLinearStepFunction</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitLinearStepFunction.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinearStepFunction.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'w',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitLinearStepFunction.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinearStepFunction.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitLinearStepFunction.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinearStepFunction.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitLinearStepFunction.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitLinearStepFunction.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitLinearStepFunction.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitPowerLaw1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.power_law_1d" title="libics.tools.math.flat.power_law_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">power_law_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>p</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>power</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitPowerLaw1d.find_p0" title="libics.tools.math.flat.FitPowerLaw1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitPowerLaw1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'p']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">1]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1dCenter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">FitPowerLaw1dCenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1dCenter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.flat.power_law_1d" title="libics.tools.math.flat.power_law_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">power_law_1d()</span></code></a> with center as fit variable.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>p</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>power</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.flat.FitPowerLaw1dCenter.find_p0" title="libics.tools.math.flat.FitPowerLaw1dCenter.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1dCenter.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.tools.math.flat.FitPowerLaw1dCenter</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1dCenter.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1dCenter.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'p',</span> <span class="pre">'x0',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1dCenter.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1dCenter.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1dCenter.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.flat.FitPowerLaw1dCenter.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.FitPowerLaw1dCenter.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.flat.cosine_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">cosine_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.cosine_1d" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.flat.cosine_2d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">cosine_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.cosine_2d" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.flat.error_function">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">error_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.error_function" title="Permalink to this definition"></a></dt>
<dd><p>Error function in one dimension.</p>
<div class="math notranslate nohighlight">
\[a \mathrm{erf}((x - x_0) / w) + c\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.flat.linear_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">linear_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.linear_1d" title="Permalink to this definition"></a></dt>
<dd><p>Linear in one dimension.</p>
<div class="math notranslate nohighlight">
\[a x + c\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.flat.linear_step_function">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">linear_step_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.linear_step_function" title="Permalink to this definition"></a></dt>
<dd><p>Linearly interpolated step function in one dimension.</p>
<div class="math notranslate nohighlight">
\[c - a (for x &lt; x_0 - w),
\frac{a}{w} (x - x_0) + c (for x_0 - w &lt; x &lt; x_0 + w),
c + a (for x &gt; x_0 + w)\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.flat.power_law_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.flat.</span></span><span class="sig-name descname"><span class="pre">power_law_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.flat.power_law_1d" title="Permalink to this definition"></a></dt>
<dd><p>Power law in one dimension.</p>
<div class="math notranslate nohighlight">
\[a (x - x_0)^p + c\]</div>
</dd></dl>

</section>
<section id="module-libics.tools.math.peaked">
<span id="peaked"></span><h2>peaked<a class="headerlink" href="#module-libics.tools.math.peaked" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitAiryDisk2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitAiryDisk2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitAiryDisk2d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.airy_disk_2d" title="libics.tools.math.peaked.airy_disk_2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">airy_disk_2d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0, y0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>w</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitAiryDisk2d.find_p0" title="libics.tools.math.peaked.FitAiryDisk2d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Algorithm: linear min/max approximation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitAiryDisk2d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitAiryDisk2d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitAiryDisk2d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitAiryDisk2d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'y0',</span> <span class="pre">'w',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitAiryDisk2d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitAiryDisk2d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitAiryDisk2d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitAiryDisk2d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitAiryDisk2d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm: linear min/max approximation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitBmGaussianParabolic1dInt2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.peaked.FitGaussian1d" title="libics.tools.math.peaked.FitGaussian1d"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.peaked.FitGaussian1d</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.bm_gaussian_parabolic_1d_int2d" title="libics.tools.math.peaked.bm_gaussian_parabolic_1d_int2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">bm_gaussian_parabolic_1d_int2d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ag, ap</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitudes of Gaussian and parabola</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wgx, wpx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width of Gaussian and parabola</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.find_p0" title="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Algorithm: find_p0 of Gaussian -&gt; split data at width -&gt; fit tails with Gaussian, center with parabola.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*args[, maxfev])</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_gaussian_1d" title="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_gaussian_1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fit_gaussian_1d</span></code></a>()</p></td>
<td><p>Gets a fit object only modelling the Gaussian part.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_parabolic_1d_int2d" title="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_parabolic_1d_int2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fit_parabolic_1d_int2d</span></code></a>()</p></td>
<td><p>Gets a fit object only modelling the parabolic part.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitBmGaussianParabolic1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['ag',</span> <span class="pre">'ap',</span> <span class="pre">'x0',</span> <span class="pre">'wgx',</span> <span class="pre">'wpx',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.5,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0.5,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm: find_p0 of Gaussian -&gt; split data at width
-&gt; fit tails with Gaussian, center with parabola.</p>
<p class="rubric">Notes</p>
<p>Currently only works for positive data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_gaussian_1d">
<span class="sig-name descname"><span class="pre">get_fit_gaussian_1d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_gaussian_1d" title="Permalink to this definition"></a></dt>
<dd><p>Gets a fit object only modelling the Gaussian part.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_parabolic_1d_int2d">
<span class="sig-name descname"><span class="pre">get_fit_parabolic_1d_int2d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic1dInt2d.get_fit_parabolic_1d_int2d" title="Permalink to this definition"></a></dt>
<dd><p>Gets a fit object only modelling the parabolic part.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitBmGaussianParabolic2dInt1dTilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.peaked.FitGaussian2dTilt" title="libics.tools.math.peaked.FitGaussian2dTilt"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.peaked.FitGaussian2dTilt</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.bm_gaussian_parabolic_2d_int1d" title="libics.tools.math.peaked.bm_gaussian_parabolic_2d_int1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">bm_gaussian_parabolic_2d_int1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ag, ap</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitudes of Gaussian and parabola</p>
</dd>
<dt><strong>x0, y0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wgu, wgv, wpu, wpv</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>widths of Gaussian and parabola</p>
</dd>
<dt><strong>tilt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>tilt in [-45°, 45°]</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ellipticity</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_p0" title="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_popt" title="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_gaussian_2d_tilt" title="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_gaussian_2d_tilt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fit_gaussian_2d_tilt</span></code></a>()</p></td>
<td><p>Gets a fit object only modelling the Gaussian part.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_parabolic_2d_int1d_tilt" title="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_parabolic_2d_int1d_tilt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fit_parabolic_2d_int1d_tilt</span></code></a>()</p></td>
<td><p>Gets a fit object only modelling the parabolic part.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitBmGaussianParabolic2dInt1dTilt</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['ag',</span> <span class="pre">'ap',</span> <span class="pre">'x0',</span> <span class="pre">'y0',</span> <span class="pre">'wgu',</span> <span class="pre">'wgv',</span> <span class="pre">'wpu',</span> <span class="pre">'wpv',</span> <span class="pre">'tilt',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.5,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0.5,</span> <span class="pre">0.5,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_p0" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>algorithm</strong><span class="classifier"><cite>str</cite></span></dt><dd><p><cite>“linear”, “fit1d”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_gaussian_2d_tilt">
<span class="sig-name descname"><span class="pre">get_fit_gaussian_2d_tilt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_gaussian_2d_tilt" title="Permalink to this definition"></a></dt>
<dd><p>Gets a fit object only modelling the Gaussian part.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_parabolic_2d_int1d_tilt">
<span class="sig-name descname"><span class="pre">get_fit_parabolic_2d_int1d_tilt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitBmGaussianParabolic2dInt1dTilt.get_fit_parabolic_2d_int1d_tilt" title="Permalink to this definition"></a></dt>
<dd><p>Gets a fit object only modelling the parabolic part.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitExponential1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.exponential_1d" title="libics.tools.math.peaked.exponential_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">exponential_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>g</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>rate</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>variable offset, assuming unity amplitude</p>
</dd>
<dt><strong>xi</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>decay length, inverse rate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitExponential1d.find_p0" title="libics.tools.math.peaked.FitExponential1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitExponential1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'g',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d.x0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d.x0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponential1d.xi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitExponential1d.xi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitExponentialDecay1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitExponentialDecay1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitExponentialDecay1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitGaussian1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.gaussian_1d" title="libics.tools.math.peaked.gaussian_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitGaussian1d.find_p0" title="libics.tools.math.peaked.FitGaussian1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitGaussian1d.find_popt" title="libics.tools.math.peaked.FitGaussian1d.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*args[, maxfev])</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitGaussian1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'wx',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian1d.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian1d.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitGaussian2dTilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.gaussian_2d_tilt" title="libics.tools.math.peaked.gaussian_2d_tilt"><code class="xref py py-func docutils literal notranslate"><span class="pre">gaussian_2d_tilt()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0, y0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wu, wv</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>tilt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>tilt in [-45°, 45°]</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ellipticity</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitGaussian2dTilt.find_p0" title="libics.tools.math.peaked.FitGaussian2dTilt.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data[, algorithm])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitGaussian2dTilt.find_popt" title="libics.tools.math.peaked.FitGaussian2dTilt.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitGaussian2dTilt</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'y0',</span> <span class="pre">'wu',</span> <span class="pre">'wv',</span> <span class="pre">'tilt',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt.ellipticity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ellipticity</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt.ellipticity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fit1d'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt.find_p0" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>algorithm</strong><span class="classifier"><cite>str</cite></span></dt><dd><p><cite>“linear”, “fit1d”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitGaussian2dTilt.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitGaussian2dTilt.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzian1dAbs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitLorentzian1dAbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzian1dAbs" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.lorentzian_1d_abs" title="libics.tools.math.peaked.lorentzian_1d_abs"><code class="xref py py-func docutils literal notranslate"><span class="pre">lorentzian_1d_abs()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitLorentzian1dAbs.find_p0" title="libics.tools.math.peaked.FitLorentzian1dAbs.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Algorithm: dummy max.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitLorentzian1dAbs.find_popt" title="libics.tools.math.peaked.FitLorentzian1dAbs.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzian1dAbs.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitLorentzian1dAbs</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzian1dAbs.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzian1dAbs.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'wx',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzian1dAbs.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzian1dAbs.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzian1dAbs.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzian1dAbs.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzian1dAbs.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm: dummy max.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzian1dAbs.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzian1dAbs.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitLorentzianEit1dImag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.lorentzian_eit_1d_imag" title="libics.tools.math.peaked.lorentzian_eit_1d_imag"><code class="xref py py-func docutils literal notranslate"><span class="pre">lorentzian_eit_1d_imag()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>x1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>shift</p>
</dd>
<dt><strong>wx1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>split</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl>
<dt><strong>ge</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>excited state decay rate</p>
</dd>
<dt><strong>fc</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>control field Rabi frequency</p>
</dd>
<dt><strong>dc</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>control field detuning</p>
</dd>
<dt><strong>lmax</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>position of left maximum</p>
</dd>
<dt><strong>rmax</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>position of right maximum</p>
</dd>
<dt><strong>cmin</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>position of central minimum</p>
</dd>
<dt><strong>lwidth, rwidth</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width of left/right maximum</p>
</dd>
<dt><strong>cwidth</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width of central minimum</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.find_p0" title="libics.tools.math.peaked.FitLorentzianEit1dImag.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.find_popt" title="libics.tools.math.peaked.FitLorentzianEit1dImag.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.get_phys" title="libics.tools.math.peaked.FitLorentzianEit1dImag.get_phys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_phys</span></code></a>()</p></td>
<td><p>Gets parameters parametrized as physical quantities.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitLorentzianEit1dImag</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'wx',</span> <span class="pre">'x1',</span> <span class="pre">'wx1',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.cmin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cmin</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.cmin" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.cwidth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cwidth</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.cwidth" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.dc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dc</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.dc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.dp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dp</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.dp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.fc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fc</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.fc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.ge">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ge</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.ge" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.get_phys">
<span class="sig-name descname"><span class="pre">get_phys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.get_phys" title="Permalink to this definition"></a></dt>
<dd><p>Gets parameters parametrized as physical quantities.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>phys</strong><span class="classifier"><cite>dict(str-&gt;float)</cite></span></dt><dd><p>Parameters: amplitude <cite>“a”</cite>, probe resonance frequency <cite>“dp”</cite>,
control resonance frequency <cite>“dc”</cite>, control Rabi frequency: <cite>“fc”</cite>,
intermediate state decay rate “ge”, offset <cite>“c”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.lmax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lmax</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.lmax" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.lwidth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lwidth</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.lwidth" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.rmax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rmax</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.rmax" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianEit1dImag.rwidth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rwidth</span></span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianEit1dImag.rwidth" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianRydEit1dImag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitLorentzianRydEit1dImag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianRydEit1dImag" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.peaked.FitLorentzianEit1dImag" title="libics.tools.math.peaked.FitLorentzianEit1dImag"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.peaked.FitLorentzianEit1dImag</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.lorentzian_ryd_eit_1d_imag" title="libics.tools.math.peaked.lorentzian_ryd_eit_1d_imag"><code class="xref py py-func docutils literal notranslate"><span class="pre">lorentzian_ryd_eit_1d_imag()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>x1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>shift</p>
</dd>
<dt><strong>wx1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>split</p>
</dd>
<dt><strong>r</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>ratio</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl>
<dt><strong>ge</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>excited state decay rate</p>
</dd>
<dt><strong>fc</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>control field Rabi frequency</p>
</dd>
<dt><strong>dc</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>control field detuning</p>
</dd>
<dt><strong>lmax, rmax</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>position of left/right maximum</p>
</dd>
<dt><strong>cmin</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>position of central minimum</p>
</dd>
<dt><strong>lwidth, rwidth</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width of left/right maximum</p>
</dd>
<dt><strong>cwidth</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width of central minimum</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitLorentzianRydEit1dImag.find_p0" title="libics.tools.math.peaked.FitLorentzianRydEit1dImag.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data[, const_p0])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_phys</span></code>()</p></td>
<td><p>Gets parameters parametrized as physical quantities.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianRydEit1dImag.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitLorentzianRydEit1dImag</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianRydEit1dImag.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianRydEit1dImag.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'wx',</span> <span class="pre">'x1',</span> <span class="pre">'wx1',</span> <span class="pre">'r',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianRydEit1dImag.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianRydEit1dImag.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0.5,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianRydEit1dImag.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitLorentzianRydEit1dImag.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitLorentzianRydEit1dImag.find_p0" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>const_p0</strong><span class="classifier"><cite>dict(str-&gt;float)</cite></span></dt><dd><p>Constant parameters which should not be fitted when estimating
<cite>p0</cite> with <cite>r == 0</cite> fit.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitParabolic1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.models.ModelBase" title="libics.tools.math.models.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.models.ModelBase</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.parabolic_1d" title="libics.tools.math.peaked.parabolic_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">parabolic_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitParabolic1d.find_p0" title="libics.tools.math.peaked.FitParabolic1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*data, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitParabolic1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1dInt2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitParabolic1dInt2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1dInt2d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.peaked.FitGaussian1d" title="libics.tools.math.peaked.FitGaussian1d"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.peaked.FitGaussian1d</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.parabolic_1d_int2d" title="libics.tools.math.peaked.parabolic_1d_int2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">parabolic_1d_int2d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitParabolic1dInt2d.find_p0" title="libics.tools.math.peaked.FitParabolic1dInt2d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*args[, maxfev])</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1dInt2d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitParabolic1dInt2d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1dInt2d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1dInt2d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'wx',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1dInt2d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1dInt2d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1dInt2d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic1dInt2d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic1dInt2d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic2dInt1dTilt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitParabolic2dInt1dTilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic2dInt1dTilt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.peaked.FitGaussian2dTilt" title="libics.tools.math.peaked.FitGaussian2dTilt"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.peaked.FitGaussian2dTilt</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.parabolic_1d_int2d" title="libics.tools.math.peaked.parabolic_1d_int2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">parabolic_1d_int2d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0, y0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wu, wv</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>tilt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>tilt in [-45°, 45°]</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ellipticity</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code>(*data[, algorithm])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic2dInt1dTilt.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitParabolic2dInt1dTilt</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic2dInt1dTilt.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic2dInt1dTilt.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'y0',</span> <span class="pre">'wu',</span> <span class="pre">'wv',</span> <span class="pre">'tilt',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic2dInt1dTilt.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitParabolic2dInt1dTilt.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitParabolic2dInt1dTilt.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">FitSkewGaussian1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.peaked.FitGaussian1d" title="libics.tools.math.peaked.FitGaussian1d"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.peaked.FitGaussian1d</span></code></a></p>
<p>Fit class for <a class="reference internal" href="#libics.tools.math.peaked.skew_gaussian_1d" title="libics.tools.math.peaked.skew_gaussian_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">skew_gaussian_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>amplitude</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>center</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>width</p>
</dd>
<dt><strong>alpha</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>parameter controlling skewness</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>offset</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">p0_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pall</span></code></dt><dd><p>dict(name-&gt;index) for all parameters</p>
</dd>
<dt><strong>pcov</strong></dt><dd></dd>
<dt><strong>pcov_for_fit</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfit</span></code></dt><dd><p>dict(name-&gt;index) for fitted parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt</span></code></dt><dd><p>All <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code> (non-fitted ones use <code class="xref py py-attr docutils literal notranslate"><span class="pre">p0</span></code>)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">popt_for_fit</span></code></dt><dd><p>Fitted <code class="xref py py-attr docutils literal notranslate"><span class="pre">popt</span></code></p>
</dd>
<dt><strong>pstd</strong></dt><dd></dd>
<dt><strong>pstd_for_fit</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(var, *args, **kwargs)</p></td>
<td><p>Calls the model function with current parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2</span></code>(*data)</p></td>
<td><p>Gets the chi squared statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_red</span></code>(*data)</p></td>
<td><p>Gets the reduced chi squared statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_chi2_significance</span></code>(*data)</p></td>
<td><p>Gets the chi squared confindence quantile for the fit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitSkewGaussian1d.find_p0" title="libics.tools.math.peaked.FitSkewGaussian1d.find_p0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_p0</span></code></a>(*data)</p></td>
<td><p>Routine for initial fit parameter finding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitSkewGaussian1d.find_popt" title="libics.tools.math.peaked.FitSkewGaussian1d.find_popt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_popt</span></code></a>(*args, **kwargs)</p></td>
<td><p>Fits the model function to the given data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code>([shape])</p></td>
<td><p>Gets a (continuos) model data array using fitted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.peaked.FitSkewGaussian1d.get_skew_normal_1d_distribution_params" title="libics.tools.math.peaked.FitSkewGaussian1d.get_skew_normal_1d_distribution_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_skew_normal_1d_distribution_params</span></code></a>()</p></td>
<td><p>Gets the equiv.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_p0</span></code>(**p0)</p></td>
<td><p>Sets initial parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pfit</span></code>(*opt[, const])</p></td>
<td><p>Set which parameters to fit.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_hypothesis_chi2</span></code>(*data[, p_value])</p></td>
<td><p>Tests the whether the fit is valid.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 64%" />
<col style="width: 36%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_p0</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_popt</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_pstd</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>p0_is_set</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>split_fit_data</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d.LOGGER">
<span class="sig-name descname"><span class="pre">LOGGER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">libics.math.peaked.FitSkewGaussian1d</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d.LOGGER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d.P_ALL">
<span class="sig-name descname"><span class="pre">P_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['a',</span> <span class="pre">'x0',</span> <span class="pre">'wx',</span> <span class="pre">'alpha',</span> <span class="pre">'c']</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d.P_ALL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d.P_DEFAULT">
<span class="sig-name descname"><span class="pre">P_DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">0]</span></em><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d.P_DEFAULT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d.find_p0">
<span class="sig-name descname"><span class="pre">find_p0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d.find_p0" title="Permalink to this definition"></a></dt>
<dd><p>Routine for initial fit parameter finding.</p>
<p>Should return whether this succeeded.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d.find_popt">
<span class="sig-name descname"><span class="pre">find_popt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d.find_popt" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model function to the given data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Any</cite></span></dt><dd><p>Data interpretable by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_split_fit_data()</span></code>.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psuccess</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether fit succeeded.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.FitSkewGaussian1d.get_skew_normal_1d_distribution_params">
<span class="sig-name descname"><span class="pre">get_skew_normal_1d_distribution_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.FitSkewGaussian1d.get_skew_normal_1d_distribution_params" title="Permalink to this definition"></a></dt>
<dd><p>Gets the equiv. <a class="reference internal" href="#libics.tools.math.peaked.SkewNormal1dDistribution" title="libics.tools.math.peaked.SkewNormal1dDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">SkewNormal1dDistribution</span></code></a> parameterization.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>params</strong><span class="classifier"><cite>dict(str-&gt;float)</cite></span></dt><dd><p>Parameter dictionary containing the keys <cite>“x0”, “wx”, “alpha”</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.RndDscBallistic1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">RndDscBallistic1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.RndDscBallistic1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats._distn_infrastructure.rv_discrete</span></code></p>
<p>1D ballistic transport site occupation random variable.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>site</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Minimum and maximum sites <cite>(site_min, site_max)</cite>.</p>
</dd>
<dt><strong>time</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Evolution time in seconds (s).</p>
</dd>
<dt><strong>hopping</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Hopping frequency in radians (rad).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_state</span></code></dt><dd><p>Get or set the RandomState object for generating random variates.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwds)</p></td>
<td><p>Freeze the distribution for the given arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdf</span></code>(k, *args, **kwds)</p></td>
<td><p>Cumulative distribution function of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy</span></code>(*args, **kwds)</p></td>
<td><p>Differential entropy of the RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expect</span></code>([func, args, loc, lb, ub, ...])</p></td>
<td><p>Calculate expected value of a function with respect to the distribution for discrete distribution by numerical summation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code>(*args, **kwds)</p></td>
<td><p>Freeze the distribution for the given arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code>(alpha, *args, **kwds)</p></td>
<td><p>Confidence interval with equal areas around the median.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">isf</span></code>(q, *args, **kwds)</p></td>
<td><p>Inverse survival function (inverse of <cite>sf</cite>) at q of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logcdf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the cumulative distribution function at k of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logpmf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the probability mass function at k of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logsf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the survival function of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code>(*args, **kwds)</p></td>
<td><p>Mean of the distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">median</span></code>(*args, **kwds)</p></td>
<td><p>Median of the distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">moment</span></code>(n, *args, **kwds)</p></td>
<td><p>n-th order non-central moment of distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pmf</span></code>(k, *args, **kwds)</p></td>
<td><p>Probability mass function at k of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ppf</span></code>(q, *args, **kwds)</p></td>
<td><p>Percent point function (inverse of <cite>cdf</cite>) at q of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rvs</span></code>(*args, **kwargs)</p></td>
<td><p>Random variates of given type.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sf</span></code>(k, *args, **kwds)</p></td>
<td><p>Survival function (1 - <cite>cdf</cite>) at k of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code>(*args, **kwds)</p></td>
<td><p>Some statistics of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">std</span></code>(*args, **kwds)</p></td>
<td><p>Standard deviation of the distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">support</span></code>(*args, **kwargs)</p></td>
<td><p>Return the support of the distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">var</span></code>(*args, **kwds)</p></td>
<td><p>Variance of the distribution.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.RndDscBlochOsc1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">RndDscBlochOsc1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.RndDscBlochOsc1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats._distn_infrastructure.rv_discrete</span></code></p>
<p>1D Bloch oscillation site occupation random variable.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>site</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Minimum and maximum sites <cite>(site_min, site_max)</cite>.</p>
</dd>
<dt><strong>time</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Evolution time in seconds (s).</p>
</dd>
<dt><strong>hopping</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Hopping frequency in radians (rad).</p>
</dd>
<dt><strong>gradient</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Frequency difference between neighbouring sites in radians (rad).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_state</span></code></dt><dd><p>Get or set the RandomState object for generating random variates.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwds)</p></td>
<td><p>Freeze the distribution for the given arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdf</span></code>(k, *args, **kwds)</p></td>
<td><p>Cumulative distribution function of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy</span></code>(*args, **kwds)</p></td>
<td><p>Differential entropy of the RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expect</span></code>([func, args, loc, lb, ub, ...])</p></td>
<td><p>Calculate expected value of a function with respect to the distribution for discrete distribution by numerical summation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code>(*args, **kwds)</p></td>
<td><p>Freeze the distribution for the given arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code>(alpha, *args, **kwds)</p></td>
<td><p>Confidence interval with equal areas around the median.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">isf</span></code>(q, *args, **kwds)</p></td>
<td><p>Inverse survival function (inverse of <cite>sf</cite>) at q of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logcdf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the cumulative distribution function at k of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logpmf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the probability mass function at k of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logsf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the survival function of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code>(*args, **kwds)</p></td>
<td><p>Mean of the distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">median</span></code>(*args, **kwds)</p></td>
<td><p>Median of the distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">moment</span></code>(n, *args, **kwds)</p></td>
<td><p>n-th order non-central moment of distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pmf</span></code>(k, *args, **kwds)</p></td>
<td><p>Probability mass function at k of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ppf</span></code>(q, *args, **kwds)</p></td>
<td><p>Percent point function (inverse of <cite>cdf</cite>) at q of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rvs</span></code>(*args, **kwargs)</p></td>
<td><p>Random variates of given type.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sf</span></code>(k, *args, **kwds)</p></td>
<td><p>Survival function (1 - <cite>cdf</cite>) at k of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code>(*args, **kwds)</p></td>
<td><p>Some statistics of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">std</span></code>(*args, **kwds)</p></td>
<td><p>Standard deviation of the distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">support</span></code>(*args, **kwargs)</p></td>
<td><p>Return the support of the distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">var</span></code>(*args, **kwds)</p></td>
<td><p>Variance of the distribution.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.RndDscDiffusive1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">RndDscDiffusive1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.RndDscDiffusive1d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats._distn_infrastructure.rv_discrete</span></code></p>
<p>1D random variable for diffusive transport on discrete sites.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>site</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Minimum and maximum sites <cite>(site_min, site_max)</cite>.</p>
</dd>
<dt><strong>time</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Evolution time in seconds (s).</p>
</dd>
<dt><strong>diffusion</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Diffusion constant in sites² per second (1/s).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_state</span></code></dt><dd><p>Get or set the RandomState object for generating random variates.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwds)</p></td>
<td><p>Freeze the distribution for the given arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdf</span></code>(k, *args, **kwds)</p></td>
<td><p>Cumulative distribution function of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">entropy</span></code>(*args, **kwds)</p></td>
<td><p>Differential entropy of the RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expect</span></code>([func, args, loc, lb, ub, ...])</p></td>
<td><p>Calculate expected value of a function with respect to the distribution for discrete distribution by numerical summation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code>(*args, **kwds)</p></td>
<td><p>Freeze the distribution for the given arguments.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code>(alpha, *args, **kwds)</p></td>
<td><p>Confidence interval with equal areas around the median.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">isf</span></code>(q, *args, **kwds)</p></td>
<td><p>Inverse survival function (inverse of <cite>sf</cite>) at q of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logcdf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the cumulative distribution function at k of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logpmf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the probability mass function at k of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logsf</span></code>(k, *args, **kwds)</p></td>
<td><p>Log of the survival function of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code>(*args, **kwds)</p></td>
<td><p>Mean of the distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">median</span></code>(*args, **kwds)</p></td>
<td><p>Median of the distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">moment</span></code>(n, *args, **kwds)</p></td>
<td><p>n-th order non-central moment of distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pmf</span></code>(k, *args, **kwds)</p></td>
<td><p>Probability mass function at k of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ppf</span></code>(q, *args, **kwds)</p></td>
<td><p>Percent point function (inverse of <cite>cdf</cite>) at q of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rvs</span></code>(*args, **kwargs)</p></td>
<td><p>Random variates of given type.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sf</span></code>(k, *args, **kwds)</p></td>
<td><p>Survival function (1 - <cite>cdf</cite>) at k of the given RV.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code>(*args, **kwds)</p></td>
<td><p>Some statistics of the given RV.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">std</span></code>(*args, **kwds)</p></td>
<td><p>Standard deviation of the distribution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">support</span></code>(*args, **kwargs)</p></td>
<td><p>Return the support of the distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">var</span></code>(*args, **kwds)</p></td>
<td><p>Variance of the distribution.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">SkewNormal1dDistribution</span></span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Namespace class for the skew normal distribution.</p>
<p>Uses the parameterization of:
<a class="reference external" href="https://en.wikipedia.org/wiki/Skew_normal_distribution">https://en.wikipedia.org/wiki/Skew_normal_distribution</a>.</p>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>amplitude</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>cdf</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>cv_skewness_to_alpha</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>ipdf</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>kurtosis</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>mean</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>minimal_overlap</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>mode</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>pdf</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>ppf</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>skewness</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>variance</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.amplitude">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.amplitude" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.cdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.cdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.cv_skewness_to_alpha">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cv_skewness_to_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skewness</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.cv_skewness_to_alpha" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.ipdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ipdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.ipdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.kurtosis">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kurtosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.kurtosis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.mean">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.mean" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.minimal_overlap">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">minimal_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.minimal_overlap" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.mode">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.mode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.pdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.pdf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.ppf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ppf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.ppf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.skewness">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">skewness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.skewness" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.peaked.SkewNormal1dDistribution.variance">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.SkewNormal1dDistribution.variance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.airy_disk_2d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">airy_disk_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.airy_disk_2d" title="Permalink to this definition"></a></dt>
<dd><div class="math notranslate nohighlight">
\[A \left( \frac{2 J_1 \left( \sqrt{(x-x_0)^2 + (y-y_0)^2} / w \right)}
              {\sqrt{(x-x_0)^2 + (y-y_0)^2} / w} \right)^2 + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((x, y)\)</span></p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(A\)</span></p>
</dd>
<dt><strong>center_x, center_y</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((x_0, y_0)\)</span></p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(w\)</span></p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(C\)</span></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Handles limiting value at <span class="math notranslate nohighlight">\((x, y) -&gt; (0, 0)\)</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.bm_gaussian_parabolic_1d_int2d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">bm_gaussian_parabolic_1d_int2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wgx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.bm_gaussian_parabolic_1d_int2d" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.bm_gaussian_parabolic_2d_int1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">bm_gaussian_parabolic_2d_int1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wgu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wgv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.bm_gaussian_parabolic_2d_int1d" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.dsc_ballistic_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">dsc_ballistic_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.dsc_ballistic_1d" title="Permalink to this definition"></a></dt>
<dd><div class="math notranslate nohighlight">
\[J_n^2 \left( 2 J t \right)\]</div>
<p>The hopping energy <span class="math notranslate nohighlight">\(J\)</span> should be given in <span class="math notranslate nohighlight">\(2 \pi\)</span> frequency
units, i.e. in units of <span class="math notranslate nohighlight">\(\hbar\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((n, t)\)</span></p>
</dd>
<dt><strong>hopping</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(J\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>res</dt><dd><p>Probability distribution of 1D ballistic transport for the given
site <cite>var[0]</cite> at the given time <cite>var[1]</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.dsc_bloch_osc_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">dsc_bloch_osc_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.dsc_bloch_osc_1d" title="Permalink to this definition"></a></dt>
<dd><div class="math notranslate nohighlight">
\[J_n^2 \left( \frac{4 J}{\Delta}
\cdot \left| \sin \frac{\Delta t}{2} \right| \right)\]</div>
<p><span class="math notranslate nohighlight">\(\Delta = F a\)</span> specifies the energy difference between neighbouring
sites with distance <span class="math notranslate nohighlight">\(a\)</span> at a potential gradient <span class="math notranslate nohighlight">\(F\)</span>.
Energies <span class="math notranslate nohighlight">\(J, \Delta\)</span> should be given in <span class="math notranslate nohighlight">\(2 \pi\)</span> frequency
units, i.e. in units of <span class="math notranslate nohighlight">\(\hbar\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((n, t)\)</span></p>
</dd>
<dt><strong>hopping</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(J\)</span></p>
</dd>
<dt><strong>gradient</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(\Delta\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>res</dt><dd><p>Probability distribution of 1D Bloch oscillations for the given
site <cite>var[0]</cite> at the given time <cite>var[1]</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.dsc_bloch_osc_2d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">dsc_bloch_osc_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.dsc_bloch_osc_2d" title="Permalink to this definition"></a></dt>
<dd><p>See <code class="xref py py-func docutils literal notranslate"><span class="pre">bloch_osc_1d()</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((n_x, n_y, t)\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.dsc_bloch_osc_3d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">dsc_bloch_osc_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.dsc_bloch_osc_3d" title="Permalink to this definition"></a></dt>
<dd><p>See <code class="xref py py-func docutils literal notranslate"><span class="pre">bloch_osc_1d()</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((n_x, n_y, n_z, t)\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.dsc_diffusive_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">dsc_diffusive_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.dsc_diffusive_1d" title="Permalink to this definition"></a></dt>
<dd><div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{4 \pi D t}}
\exp \left( -\frac{n^2}{4 D t} \right)\]</div>
<p>The diffusion constant <span class="math notranslate nohighlight">\(D\)</span> should be given in units of the
lattice constant <span class="math notranslate nohighlight">\(a\)</span>, i.e. <span class="math notranslate nohighlight">\(D_\text{SI} = D / a^2\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\((n, t)\)</span></p>
</dd>
<dt><strong>diffusion</strong><span class="classifier"><cite>float</cite></span></dt><dd><p><span class="math notranslate nohighlight">\(D\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>res</dt><dd><p>Probability distribution of 1D ballistic transport for the given
site <cite>var[0]</cite> at the given time <cite>var[1]</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.exponential_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">exponential_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.exponential_1d" title="Permalink to this definition"></a></dt>
<dd><p>Exponential function in one dimension.</p>
<div class="math notranslate nohighlight">
\[A e^{\gamma x} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>rate</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Rate of exponential <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.exponential_decay_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">exponential_decay_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.exponential_decay_1d" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.exponential_decay_nd">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">exponential_decay_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.exponential_decay_nd" title="Permalink to this definition"></a></dt>
<dd><p>Exponential decay in <span class="math notranslate nohighlight">\(n\)</span> dimensions.</p>
<div class="math notranslate nohighlight">
\[A e^{-\sum_{i=1}^n \frac{|x_i - c_i|}{\xi_i}} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Variables <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Centers <span class="math notranslate nohighlight">\(c_i\)</span>.</p>
</dd>
<dt><strong>length</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Characteristic lengths <span class="math notranslate nohighlight">\(\xi_i\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.gamma_distribution_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">gamma_distribution_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.gamma_distribution_1d" title="Permalink to this definition"></a></dt>
<dd><p>Gamma distribution in one dimension.</p>
<div class="math notranslate nohighlight">
\[A \frac{(N / \mu)^N}{\Gamma (N)} x^{N - 1}
e^{-\frac{N}{\mu} x} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>mean</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Mean <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
</dd>
<dt><strong>number</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Number <span class="math notranslate nohighlight">\(N\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.gaussian_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">gaussian_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.gaussian_1d" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian in one dimension.</p>
<div class="math notranslate nohighlight">
\[A e^{-\frac{(x - c)^2}{2 \sigma^2}} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Center <span class="math notranslate nohighlight">\(c\)</span>.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Width <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.gaussian_2d_tilt">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">gaussian_2d_tilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.gaussian_2d_tilt" title="Permalink to this definition"></a></dt>
<dd><p>Tilted (rotated) Gaussian in two dimensions.</p>
<div class="math notranslate nohighlight">
\[A e^{-\frac{((x - x_0) \cos \theta + (y - y_0) \sin \theta))^2}
           {2 \sigma_u^2}
     -\frac{((y - y_0) \cos \theta - (x - x_0) \sin \theta))^2}
           {2 \sigma_v^2}} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>var</strong><span class="classifier"><cite>numpy.array(2, float)</cite></span></dt><dd><p>Variables <span class="math notranslate nohighlight">\(x, y\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>center_x, center_y</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Centers <span class="math notranslate nohighlight">\(x_0, y_0\)</span>.</p>
</dd>
<dt><strong>width_u, width_v</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Widths <span class="math notranslate nohighlight">\(\sigma_u, \sigma_v\)</span>.</p>
</dd>
<dt><strong>tilt</strong><span class="classifier"><cite>float(0, numpy.pi)</cite></span></dt><dd><p>Tilt angle <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.gaussian_nd">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">gaussian_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.gaussian_nd" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian in <span class="math notranslate nohighlight">\(n\)</span> dimensions.</p>
<div class="math notranslate nohighlight">
\[A e^{-\sum_{i=1}^n \left( \frac{x_i - c_i}{2 \sigma_i} \right)^2} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Variables <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Centers <span class="math notranslate nohighlight">\(c_i\)</span>.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Widths <span class="math notranslate nohighlight">\(\sigma_i\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.gaussian_nd_centered">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">gaussian_nd_centered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.gaussian_nd_centered" title="Permalink to this definition"></a></dt>
<dd><p>Centered Gaussian in <span class="math notranslate nohighlight">\(n\)</span> dimensions.</p>
<div class="math notranslate nohighlight">
\[A e^{-\sum_{i=1}^n \left( \frac{x_i}{2 \sigma_i} \right)^2} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Variables <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Widths <span class="math notranslate nohighlight">\(\sigma_i\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.gaussian_nd_symmetric">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">gaussian_nd_symmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.gaussian_nd_symmetric" title="Permalink to this definition"></a></dt>
<dd><p>Symmetric Gaussian in <span class="math notranslate nohighlight">\(n\)</span> dimensions.</p>
<div class="math notranslate nohighlight">
\[A e^{-\sum_{i=1}^n \left( \frac{x_i - c_i}{2 \sigma} \right)^2} + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Variables <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Centers <span class="math notranslate nohighlight">\(c_i\)</span>.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>numpy.array(n, float)</cite></span></dt><dd><p>Width <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.lorentzian_1d_abs">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">lorentzian_1d_abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.lorentzian_1d_abs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.lorentzian_1d_complex">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">lorentzian_1d_complex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.lorentzian_1d_complex" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.lorentzian_eit_1d_imag">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">lorentzian_eit_1d_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.lorentzian_eit_1d_imag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.lorentzian_ryd_eit_1d_imag">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">lorentzian_ryd_eit_1d_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.lorentzian_ryd_eit_1d_imag" title="Permalink to this definition"></a></dt>
<dd><p>See <a class="reference internal" href="#libics.tools.math.peaked.lorentzian_eit_1d_imag" title="libics.tools.math.peaked.lorentzian_eit_1d_imag"><code class="xref py py-func docutils literal notranslate"><span class="pre">lorentzian_eit_1d_imag()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ratio</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Rydberg fraction (ratio of non-EIT).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.parabolic_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">parabolic_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.parabolic_1d" title="Permalink to this definition"></a></dt>
<dd><p>Parabola in one dimension.</p>
<div class="math notranslate nohighlight">
\[A (x - x_0) + C\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
</dd>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Center <span class="math notranslate nohighlight">\(x_0\)</span>.</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.parabolic_1d_finsup">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">parabolic_1d_finsup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.parabolic_1d_finsup" title="Permalink to this definition"></a></dt>
<dd><p>Parabola on finite support in one dimension.</p>
<div class="math notranslate nohighlight">
\[\left(a - \frac{\sign{a}}{2} \left(\frac{x - x_0}{w_x}\right)^2\right)
\Theta (w_x \sqrt{2 A} - |x - x_0|) + c\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
</dd>
<dt><strong>a</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Center <span class="math notranslate nohighlight">\(x_0\)</span>.</p>
</dd>
<dt><strong>wx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Width of parabola <span class="math notranslate nohighlight">\(w_x\)</span>.
Normalized to be consistent with Gaussian width in series expansion.</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.parabolic_1d_int2d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">parabolic_1d_int2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.parabolic_1d_int2d" title="Permalink to this definition"></a></dt>
<dd><p>3D parabola on finite support integrated over two dimensions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.parabolic_2d_int1d_tilt">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">parabolic_2d_int1d_tilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.parabolic_2d_int1d_tilt" title="Permalink to this definition"></a></dt>
<dd><p>3D parabola on finite support integrated over one dimension.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.peaked.skew_gaussian_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.peaked.</span></span><span class="sig-name descname"><span class="pre">skew_gaussian_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.peaked.skew_gaussian_1d" title="Permalink to this definition"></a></dt>
<dd><p>Skewed Gaussian in one dimension.</p>
<p>See: <a class="reference external" href="https://en.wikipedia.org/wiki/Skew_normal_distribution">https://en.wikipedia.org/wiki/Skew_normal_distribution</a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Variable.</p>
</dd>
<dt><strong>amplitude</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Amplitude of PDF.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Mode of PDF.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Standard deviation of PDF.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Parameter controlling skewness.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite>, optional (default: 0)</span></dt><dd><p>Offset <span class="math notranslate nohighlight">\(C\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-libics.tools.math.intervalfunc">
<span id="intervalfunc"></span><h2>intervalfunc<a class="headerlink" href="#module-libics.tools.math.intervalfunc" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">IntervalSeries</span></span><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container class for a series of interval functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>size</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.intervalfunc.IntervalSeries.append" title="libics.tools.math.intervalfunc.IntervalSeries.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a>(*data[, func, t0, dt, y0, y1, args, ...])</p></td>
<td><p>Appends interval function data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.intervalfunc.IntervalSeries.get_blocks" title="libics.tools.math.intervalfunc.IntervalSeries.get_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_blocks</span></code></a>([iv_gap])</p></td>
<td><p>Calculates the block intervals.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.intervalfunc.IntervalSeries.get_data" title="libics.tools.math.intervalfunc.IntervalSeries.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a>([mode, iv_gap, num])</p></td>
<td><p>Gets the evaluated data traces.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.intervalfunc.IntervalSeries.get_times" title="libics.tools.math.intervalfunc.IntervalSeries.get_times"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_times</span></code></a>([iv_gap])</p></td>
<td><p>Calculates the time intervals from specified start times and durations.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries.KEYS">
<span class="sig-name descname"><span class="pre">KEYS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'args',</span> <span class="pre">'dt',</span> <span class="pre">'func',</span> <span class="pre">'kwargs',</span> <span class="pre">'t0',</span> <span class="pre">'y0',</span> <span class="pre">'y1'}</span></em><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries.KEYS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries.append" title="Permalink to this definition"></a></dt>
<dd><p>Appends interval function data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries.get_blocks">
<span class="sig-name descname"><span class="pre">get_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iv_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries.get_blocks" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the block intervals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iv_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Gets the evaluated data traces.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>mode</strong><span class="classifier"><cite>str</cite></span></dt><dd><p><cite>“val”</cite>: Independent variable is set by value.
<cite>“block”</cite>: Independent variable is set by block.</p>
</dd>
<dt><strong>iv_gap</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Default gap between subsequent intervals.
<cite>val</cite> mode: Used when start times are not explicitly specified.</p>
</dd>
<dt><strong>num</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Points per interval trace.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ivs</strong><span class="classifier"><cite>list(ArrayData(1, float))</cite></span></dt><dd><p>Traces of intervals with length <cite>self.size</cite>.</p>
</dd>
<dt><strong>gaps</strong><span class="classifier"><cite>list(ArrayData(1, float))</cite></span></dt><dd><p>Traces of gaps between intervals with length <cite>self.size - 1</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries.get_times">
<span class="sig-name descname"><span class="pre">get_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iv_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries.get_times" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the time intervals from specified start times and durations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.IntervalSeries.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#libics.tools.math.intervalfunc.IntervalSeries.size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.assume_func">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">assume_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.assume_func" title="Permalink to this definition"></a></dt>
<dd><p>Returns an interval function within this module.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>func</strong><span class="classifier"><cite>str</cite> or <cite>callable</cite></span></dt><dd><p>If <cite>callable</cite> returns input. If <cite>str</cite>, gets the module-scoped
function by name.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>func</strong><span class="classifier"><cite>callable</cite></span></dt><dd><p>Requested function.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.cosh">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.cosh" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for cosh</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.exp">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.exp" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for exp</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.gauss">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.gauss" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for gauss</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.interval_func">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">interval_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">rescale_param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.interval_func" title="Permalink to this definition"></a></dt>
<dd><p>Interval function factory.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*rescale_param</strong><span class="classifier"><cite>int</cite> or <cite>str</cite></span></dt><dd><p>Function call parameters which should be rescaled by the interval
length <cite>dt</cite>.
Use <cite>int</cite> to specify the indices of positional arguments.
Use <cite>str</cite> to specify the keys of keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>_ivf_factory</strong><span class="classifier"><cite>callable</cite></span></dt><dd><p>Decorator for function <cite>func</cite>.
Functions with call signature: <cite>func(t, y0, y1, *args)</cite>,
where <cite>t</cite> is the independent variable defined on the interval <cite>[0, 1]</cite>,
<cite>y0</cite> and <cite>y1</cite> are the functional values at <cite>t = 0</cite> and <cite>t = 1</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To specify positional argument <cite>p1</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@interval_func</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>To specify keyword argument <cite>“k2”</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@interval_func</span><span class="p">(</span><span class="s2">&quot;k2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">k0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.lin">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">lin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.lin" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for lin</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.step">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.step" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for step</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.tanh">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.tanh" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for tanh</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.intervalfunc.trapez">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.intervalfunc.</span></span><span class="sig-name descname"><span class="pre">trapez</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.intervalfunc.trapez" title="Permalink to this definition"></a></dt>
<dd><p>Interval function for trapez</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><cite>Array</cite> or <cite>Scalar</cite></span></dt><dd><p>Independent variable.</p>
</dd>
<dt><strong>y0, y1</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Start, stop value.</p>
</dd>
<dt><strong>t0, t1, dt</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Interval start value/stop value/extent.
Specifying <cite>t1</cite> takes precedence over <cite>dt</cite>.</p>
</dd>
<dt><strong>rescale</strong><span class="classifier"><cite>bool</cite> or <cite>float</cite></span></dt><dd><p>Whether to rescale scale-dependent function 
parameters.
If <cite>float</cite>, uses given value for rescaling.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-libics.tools.math.calculus">
<span id="calculus"></span><h2>calculus<a class="headerlink" href="#module-libics.tools.math.calculus" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.calculus.differentiate_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.calculus.</span></span><span class="sig-name descname"><span class="pre">differentiate_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.calculus.differentiate_array" title="Permalink to this definition"></a></dt>
<dd><p>Differentiates an array.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>Array</cite></span></dt><dd><p>Function represented by an array.</p>
</dd>
<dt><strong>x</strong><span class="classifier"><cite>Array(1, float)</cite></span></dt><dd><p>Coordinates to differentiate along. Overwrites <cite>dx</cite>.
If not given, deduces <cite>x</cite> from <cite>ar</cite>.</p>
</dd>
<dt><strong>dx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Coordinate steps to differentiate along.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Array dimension to differentiate along.</p>
</dd>
<dt><strong>edge_order</strong><span class="classifier"><cite>1</cite> or <cite>2</cite></span></dt><dd><p>Numerical differentiation using first/second-order-accurate
differences at the boundaries.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ar_dif</strong><span class="classifier"><cite>Array</cite></span></dt><dd><p>Differentiated array of same type as <cite>ar</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.calculus.integrate_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.calculus.</span></span><span class="sig-name descname"><span class="pre">integrate_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.calculus.integrate_array" title="Permalink to this definition"></a></dt>
<dd><p>Performs a definite or indefinite 1D integral of an array.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>Array</cite></span></dt><dd><p>Function represented by an array.</p>
</dd>
<dt><strong>bounds</strong><span class="classifier"><cite>bool</cite> or <cite>tuple(float)</cite></span></dt><dd><p><cite>False</cite>: performs indefinite integral.
<cite>True</cite>: performs definite integral over full array.
<cite>tuple(float)</cite>: integration bounds <cite>[xmin, xmax]</cite>.</p>
</dd>
<dt><strong>x</strong><span class="classifier"><cite>Array(1, float)</cite></span></dt><dd><p>Coordinates to integrate along. Overwrites <cite>dx</cite>.
If not given, deduces <cite>x</cite> from <cite>ar</cite>.</p>
</dd>
<dt><strong>dx</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Coordinate steps to integrate along.</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>None</cite> or <cite>float</cite></span></dt><dd><p>Used only for indefinite integration, where
<span class="math notranslate nohighlight">\(F(x) = \int_{x_0}^{x} f(x') dx'\)</span>.
If <cite>None</cite>, sets the integration constant to zero.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Array dimension to integrate along.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ar_int</strong><span class="classifier"><cite>Array</cite> or <cite>Number</cite></span></dt><dd><p>If indefinite integration, returns same type as <cite>ar</cite>.
If definite integration, removes one dimension of <cite>ar</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-libics.tools.math.sampling">
<span id="sampling"></span><h2>sampling<a class="headerlink" href="#module-libics.tools.math.sampling" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.sampling.get_nonlinear_support_points">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.sampling.</span></span><span class="sig-name descname"><span class="pre">get_nonlinear_support_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'slope'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.sampling.get_nonlinear_support_points" title="Permalink to this definition"></a></dt>
<dd><p>Creates a set of support points that are distributed to maximize sampling
around regions of interest.</p>
<p>The overall idea is to distribute the sampling points to obtain an
equidistant spacing by some critertion. Choosing “slope” as an example,
the returned sampling points are weighted with the respective slope of the
function.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>start</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Startpoint of scan. Will always be in final set of support points.</p>
</dd>
<dt><strong>stop</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Last point of scan. Will always be in final set of support points.</p>
</dd>
<dt><strong>nr_points</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Number of points in final set of support points.</p>
</dd>
<dt><strong>func</strong><span class="classifier"><cite>callable</cite></span></dt><dd><p>A known a priori function that we want to sample.</p>
</dd>
<dt><strong>offset</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Level of offset added to any background region of un-interest
(meaning if we filter for “curvature”, any region without curvature is
of un-interest).
If set to 0, no sample points can be found in the regions without
interest.</p>
</dd>
<dt><strong>method</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>Possible strings are <cite>[“slope”, “curvature”, “max”, “equidistant”]</cite>.
The method defines the region of interest where the sample points are
generated.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional arguments to be passed on to <cite>func</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>x</strong><span class="classifier"><cite>np.ndarray(float)</cite></span></dt><dd><p>Support points ranging from start to stop with special weight given
according to <cite>method</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-libics.tools.math.signal">
<span id="signal"></span><h2>signal<a class="headerlink" href="#module-libics.tools.math.signal" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.signal.PeakInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">PeakInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subpeak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.PeakInfo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Results class for peak analysis.</p>
<dl class="field-list">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl>
<dt><strong>data</strong><span class="classifier"><cite>ArrayData(1, float)</cite></span></dt><dd><p>Raw peak data.</p>
</dd>
<dt><strong>fit</strong><span class="classifier"><cite>FitSkewGaussian1d</cite></span></dt><dd><p>Fit model object representing best skew Gaussian fit to the raw data.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>(Fitted) maximum position of peak.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>(Fitted) standard deviation of peak.</p>
</dd>
<dt><strong>base</strong><span class="classifier"><cite>(float, float)</cite></span></dt><dd><p>(Left, right) base position corresponding to the estimated
range of the fit validity.</p>
</dd>
<dt><strong>subpeak</strong><span class="classifier"><cite>None</cite> or <cite>PeakInfo</cite></span></dt><dd><p>If <cite>None</cite>, no substructure in the peak is estimated.
If <cite>PeakInfo</cite>, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit</span></code> may be insufficient to describe
the peak, hence another subpeak is fitted (using only data outside
of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">base</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.signal.PeakInfo.get_model_data" title="libics.tools.math.signal.PeakInfo.get_model_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model_data</span></code></a>()</p></td>
<td><p>Gets the fitted peak data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.signal.PeakInfo.iter_peaks" title="libics.tools.math.signal.PeakInfo.iter_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter_peaks</span></code></a>()</p></td>
<td><p>Recursively iterates all peaks (both top-level peak and subpeaks).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.signal.PeakInfo.iter_subpeaks" title="libics.tools.math.signal.PeakInfo.iter_subpeaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter_subpeaks</span></code></a>()</p></td>
<td><p>Recursively iterates all subpeaks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.signal.PeakInfo.minimal_overlap" title="libics.tools.math.signal.PeakInfo.minimal_overlap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimal_overlap</span></code></a>(peak_info_left, peak_info_right)</p></td>
<td><p>Finds the position where the overlap between peaks is minimal.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.signal.PeakInfo.get_model_data">
<span class="sig-name descname"><span class="pre">get_model_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.PeakInfo.get_model_data" title="Permalink to this definition"></a></dt>
<dd><p>Gets the fitted peak data.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>ad</strong><span class="classifier"><cite>ArrayData(1, float)</cite></span></dt><dd><p>Fitted peak data evaluated at the positions of the raw data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.signal.PeakInfo.iter_peaks">
<span class="sig-name descname"><span class="pre">iter_peaks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.PeakInfo.iter_peaks" title="Permalink to this definition"></a></dt>
<dd><p>Recursively iterates all peaks (both top-level peak and subpeaks).</p>
<dl class="field-list">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><dl>
<dt><strong>peak</strong><span class="classifier"><cite>PeakInfo</cite></span></dt><dd><p>Peak.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.signal.PeakInfo.iter_subpeaks">
<span class="sig-name descname"><span class="pre">iter_subpeaks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.PeakInfo.iter_subpeaks" title="Permalink to this definition"></a></dt>
<dd><p>Recursively iterates all subpeaks.</p>
<dl class="field-list">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><dl>
<dt><strong>subpeak</strong><span class="classifier"><cite>PeakInfo</cite></span></dt><dd><p>Subpeak.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.signal.PeakInfo.minimal_overlap">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">minimal_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peak_info_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_info_right</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.PeakInfo.minimal_overlap" title="Permalink to this definition"></a></dt>
<dd><p>Finds the position where the overlap between peaks is minimal.</p>
<p>This position is calculated by making the absolute mass on the
“wrong” side of each peak equal.
Takes the total mass of each peak into account</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>peak_info_left, peak_info_right</strong><span class="classifier"><cite>PeakInfo</cite></span></dt><dd><p>Left and right peaks.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>xs</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Peak separation position.</p>
</dd>
<dt><strong>overlapl, overlapr</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Probability for the (left, right) peak to be on the wrong side
of the separation line (i.e., the separation error probability).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.signal.PeakInfo.nsubpeaks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nsubpeaks</span></span><a class="headerlink" href="#libics.tools.math.signal.PeakInfo.nsubpeaks" title="Permalink to this definition"></a></dt>
<dd><p>Number of subpeaks.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.signal.analyze_single_peak">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">analyze_single_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peak_ad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_subpeaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_width_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_subpeak_len_abs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_subpeak_len_rel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_is_recursion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.analyze_single_peak" title="Permalink to this definition"></a></dt>
<dd><p>Fits a peak with a skew Gaussian.</p>
<p>Recursively fits subpeaks to residuals.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>peak_ad</strong><span class="classifier"><cite>Array[1, float]</cite></span></dt><dd><p>Raw peak data.</p>
</dd>
<dt><strong>max_subpeaks</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Maximal number of subpeaks to be fitted.</p>
</dd>
<dt><strong>x0</strong><span class="classifier"><cite>float</cite> or <cite>None</cite></span></dt><dd><p>If <cite>float</cite>, fixes the peak maximum position, thereby
removing one fit degree of freedom. Only applied to top-level peak.</p>
</dd>
<dt><strong>c</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Fixed peak background level. Only applied to top-level peak.</p>
</dd>
<dt><strong>max_width_std</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Maximum fit uncertainty for the width to not continue to search
for subpeaks.</p>
</dd>
<dt><strong>min_subpeak_len_abs</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Minimum absolute number of data points to attempt subpeak fit.</p>
</dd>
<dt><strong>min_subpeak_len_rel</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Minimum relative number of points outside the peak base
to attempt subpeak fit.</p>
</dd>
<dt><strong>maxfev</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Maximum number of function evaluations for the fit.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>peak_info</strong><span class="classifier"><cite>PeakInfo</cite> or <cite>None</cite></span></dt><dd><p>If a peak could be fitted, returns a peak information object.
If not, returns <cite>None</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.signal.correlate_g2">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">correlate_g2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.correlate_g2" title="Permalink to this definition"></a></dt>
<dd><p>Calculates a multidimensional two-point cross-correlation.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>d1, d2</strong><span class="classifier"><cite>Arraylike</cite></span></dt><dd><p>Input arrays.</p>
</dd>
<dt><strong>connected</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether to calculate connected correlation (E[x,y]-E[x]E[y]).</p>
</dd>
<dt><strong>norm</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether to calculate normalized correlation (E[x,y]/E[x]E[y]).</p>
</dd>
<dt><strong>mode</strong><span class="classifier"><cite>str</cite></span></dt><dd><p><cite>“valid”, “full”, “same”</cite>.</p>
</dd>
<dt><strong>method</strong><span class="classifier"><cite>str</cite></span></dt><dd><p><cite>“direct”, “fft”, “auto”</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>dc</strong><span class="classifier"><cite>Arraylike</cite></span></dt><dd><p>Correlation array of the same data type as the input arrays.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.signal.find_histogram">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">find_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.find_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Finds a 1D histogram.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>data</strong><span class="classifier"><cite>Array[float]</cite></span></dt><dd><p>Array on which to calculate histogram.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments passed to <cite>np.histogram</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>hist</strong><span class="classifier"><cite>ArrayData(1, float or int)</cite></span></dt><dd><p>(Flattened) histogram.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.signal.find_peak_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">find_peak_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.find_peak_1d" title="Permalink to this definition"></a></dt>
<dd><p>Single-peak wrapper for <a class="reference internal" href="#libics.tools.math.signal.find_peaks_1d" title="libics.tools.math.signal.find_peaks_1d"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_peaks_1d()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Array[1, float]</cite> or <cite>(Array[1, float], Array[1, float])</cite></span></dt><dd><p>1D data to find peaks in.
Data may be provided as <cite>ArrayData</cite>, <cite>data</cite> or <cite>x, y</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>center, center_err</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Peak position and uncertainty.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.signal.find_peaks_1d">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">find_peaks_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npeaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.55</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_npeaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_prominence_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_DEBUG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.find_peaks_1d" title="Permalink to this definition"></a></dt>
<dd><p>Finds the peaks of a 1D array by peak prominence.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Array[1, float]</cite> or <cite>(Array[1, float], Array[1, float])</cite></span></dt><dd><p>1D data to find peaks in.
Data may be provided as <cite>ArrayData</cite>, <cite>data</cite> or <cite>x, y</cite>.</p>
</dd>
<dt><strong>npeaks</strong><span class="classifier"><cite>int</cite> or <cite>None</cite></span></dt><dd><p>Number of peaks to be found.
If <cite>None</cite>, determines <cite>npeaks</cite> from <cite>rel_prominence</cite>.</p>
</dd>
<dt><strong>rel_prominence</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Minimum relative prominence of peak w.r.t. mean of other found peaks.</p>
</dd>
<dt><strong>base_prominence_ratio</strong><span class="classifier"><cite>float</cite> or <cite>None</cite></span></dt><dd><p>If <cite>None</cite>: the size of the base is unrestricted.
If <cite>float</cite>: the base of a peak may not extend into the base of
secondary peaks if these peaks have a relative prominence that is
higher than <cite>base_prominence_ratio</cite>.</p>
</dd>
<dt><strong>edge_peaks</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether to allow the array edge to be considered as peak.</p>
</dd>
<dt><strong>check_npeaks</strong><span class="classifier"><cite>bool</cite> or <cite>str</cite></span></dt><dd><p>If <cite>npeaks</cite> is given, checks that <cite>npeaks</cite> is smaller or equal to
the number of peaks found by <cite>rel_prominence</cite>.
Performs the following actions if this condition is not fulfilled:
If <cite>error</cite>, raises <cite>RuntimeError</cite>.
If <cite>warning</cite> or <cite>True</cite>, prints a warning.
If <cite>False</cite>, does not perform the check.</p>
</dd>
<dt><strong>fit_algorithm</strong><span class="classifier"><cite>str</cite> or <cite>type(ModelBase)</cite></span></dt><dd><p>Which algorithm to use for peak fitting among:
<cite>“mean”, “gaussian”, “lorentzian”</cite>.
Alternatively, a model class can be given. It must be subclassed
from <cite>libics.tools.models.ModelBase</cite>; its center parameter must be
called <cite>x0</cite>, its width <cite>wx</cite>.</p>
</dd>
<dt><strong>ret_vals</strong><span class="classifier"><cite>Iter[str]</cite></span></dt><dd><p>Sets which values to return. Available options:
<cite>“width”, “fit”</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><cite>dict(str-&gt;list(float))</cite></span></dt><dd><p>Dictionary containing the following items:</p>
</dd>
<dt>center, center_err</dt><dd><p>Peak positions and uncertainties.</p>
</dd>
<dt>width</dt><dd><p>Peak width.</p>
</dd>
<dt>fit</dt><dd><p>Fit object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.signal.find_peaks_1d_prominence">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.signal.</span></span><span class="sig-name descname"><span class="pre">find_peaks_1d_prominence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npeaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.55</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_prominence_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_npeaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'warning'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.signal.find_peaks_1d_prominence" title="Permalink to this definition"></a></dt>
<dd><p>Finds positive peaks in 1D data by peak prominence.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*data</strong><span class="classifier"><cite>Array[1, float]</cite> or <cite>(Array[1, float], Array[1, float])</cite></span></dt><dd><p>1D data to find peaks in.
Data may be provided as <cite>ArrayData</cite>, <cite>data</cite> or <cite>x, y</cite>.</p>
</dd>
<dt><strong>npeaks</strong><span class="classifier"><cite>int</cite> or <cite>None</cite></span></dt><dd><p>Number of peaks to be found.
If <cite>None</cite>, determines <cite>npeaks</cite> from <cite>rel_prominence</cite>.</p>
</dd>
<dt><strong>rel_prominence</strong><span class="classifier"><cite>float</cite></span></dt><dd><p>Minimum relative prominence of peak w.r.t. mean of other found peaks.</p>
</dd>
<dt><strong>base_prominence_ratio</strong><span class="classifier"><cite>float</cite> or <cite>None</cite></span></dt><dd><p>If <cite>None</cite>: the size of the base is unrestricted.
If <cite>float</cite>: the base of a peak may not extend into the base of
secondary peaks if these peaks have a relative prominence that is
higher than <cite>base_prominence_ratio</cite>.</p>
</dd>
<dt><strong>edge_peaks</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Whether to allow the array edge to be considered as peak.</p>
</dd>
<dt><strong>check_npeaks</strong><span class="classifier"><cite>bool</cite> or <cite>str</cite></span></dt><dd><p>If <cite>npeaks</cite> is given, checks that <cite>npeaks</cite> is smaller or equal to
the number of peaks found by <cite>rel_prominence</cite>.
Performs the following actions if this condition is not fulfilled:
If <cite>error</cite>, raises <cite>RuntimeError</cite>.
If <cite>warning</cite> or <cite>True</cite>, prints a warning.
If <cite>False</cite>, does not perform the check.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ret</strong><span class="classifier"><cite>dict(str-&gt;Array[1, Any])</cite></span></dt><dd><p>Dictionary containing the following items:</p>
</dd>
<dt><strong>position</strong><span class="classifier"><cite>np.ndarray(1, float)</cite></span></dt><dd><p>Raw position of each peak.</p>
</dd>
<dt><strong>data</strong><span class="classifier"><cite>list(ArrayData)</cite></span></dt><dd><p>List of sliced data containing the data of each peak.</p>
</dd>
<dt><strong>prominence</strong><span class="classifier"><cite>np.ndarray(1, float)</cite></span></dt><dd><p>Prominence of each peak.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-libics.tools.math.tensor">
<span id="tensor"></span><h2>tensor<a class="headerlink" href="#module-libics.tools.math.tensor" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">DiagonalizableLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.tensor.LinearSystem" title="libics.tools.math.tensor.LinearSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.tensor.LinearSystem</span></code></a></p>
<p>Eigensystem solver for arbitrary square diagonalizable matrices.</p>
<p>The linear system is defined as</p>
<div class="math notranslate nohighlight">
\[M x = y, x = \sum_p b_p m_p,\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the matrix, <span class="math notranslate nohighlight">\(x\)</span> is the solution vector,
<span class="math notranslate nohighlight">\(y\)</span> is the result vector, <span class="math notranslate nohighlight">\((\mu_p, m_p)\)</span> is the eigensystem
and <span class="math notranslate nohighlight">\(b_p\)</span> is the eigenvector decomposition.</p>
<p>If the matrix has additional properties, please use the subclasses
<a class="reference internal" href="#libics.tools.math.tensor.HermitianLS" title="libics.tools.math.tensor.HermitianLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">HermitianLS</span></code></a> and <a class="reference internal" href="#libics.tools.math.tensor.SymmetricLS" title="libics.tools.math.tensor.SymmetricLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricLS</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>Usage:</p>
<ul class="simple">
<li><p>Initialization: Set the matrix defining the linear system. Set the axes
for higher rank tensors.</p></li>
<li><p>Given the matrix <span class="math notranslate nohighlight">\(M\)</span>, this class allows for (1.) the calculation
of the eigensystem <span class="math notranslate nohighlight">\((\mu_p, m_p)\)</span>, (2.) solving for <span class="math notranslate nohighlight">\(x\)</span>,
and (3.) calculating the result <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
</ul>
<ol class="arabic simple">
<li><p>Run <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.calc_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.calc_eigensystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_eigensystem()</span></code></a> to calculate eigenvalues and
left/right eigenvectors.</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>If the eigenvalues should be arranged meaningfully, they can be
ordered using <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_eigensystem()</span></code></a>.</p></li>
<li><p>For non-symmetric and non-Hermitian matrices or for degenerate
eigenvalues, the eigenvectors are not orthogonal. A computationally
expensive orthonormalization can be obtained with
<a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ortho_eigensystem()</span></code></a>.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Given the result vector <span class="math notranslate nohighlight">\(y\)</span>, there are two options to solve for
<span class="math notranslate nohighlight">\(x\)</span>.</p>
<ol class="loweralpha simple">
<li><p>If the eigensystem was calculated before, one can use
<a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.decomp_result" title="libics.tools.math.tensor.DiagonalizableLS.decomp_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decomp_result()</span></code></a> to obtain the eigenvector decomposition.
Subsequently calling <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.calc_solution" title="libics.tools.math.tensor.DiagonalizableLS.calc_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_solution()</span></code></a> calculates the
solution vector <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Alternatively, the solution can be obtained without eigensystem
decomposition with <code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code>, which only populates
the solution vector <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ol>
</li>
<li><p>Given the solution vector <span class="math notranslate nohighlight">\(x\)</span>, there are two options to obtain
the result <span class="math notranslate nohighlight">\(y\)</span>.</p>
<ol class="loweralpha simple">
<li><p>If the eigensystem was calculated before, one can use
<a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.decomp_solution" title="libics.tools.math.tensor.DiagonalizableLS.decomp_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decomp_solution()</span></code></a> to obtain the eigenvector
decomposition. Subsequently calling <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.calc_result" title="libics.tools.math.tensor.DiagonalizableLS.calc_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_result()</span></code></a>
calculates the result vector <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
<li><p>Alternatively, the result can be obtained without eigensystem
decomposition with <code class="xref py py-meth docutils literal notranslate"><span class="pre">eval()</span></code>, which only populates
the result vector <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
</ol>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>decomp</strong></dt><dd></dd>
<dt><strong>eigvals</strong></dt><dd></dd>
<dt><strong>eigvecs</strong></dt><dd></dd>
<dt><strong>is_defective</strong></dt><dd></dd>
<dt><strong>is_diagonalizable</strong></dt><dd></dd>
<dt><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.is_invertible" title="libics.tools.math.tensor.DiagonalizableLS.is_invertible"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_invertible</span></code></a></dt><dd><p>Checks the rank of the matrix.</p>
</dd>
<dt><strong>is_singular</strong></dt><dd></dd>
<dt><strong>leigvecs</strong></dt><dd></dd>
<dt><strong>mata_axes</strong></dt><dd></dd>
<dt><strong>matb_axes</strong></dt><dd></dd>
<dt><strong>matrix</strong></dt><dd></dd>
<dt><strong>reigvecs</strong></dt><dd></dd>
<dt><strong>result</strong></dt><dd></dd>
<dt><strong>solution</strong></dt><dd></dd>
<dt><strong>vec_axes</strong></dt><dd></dd>
<dt><strong>veca_axes</strong></dt><dd></dd>
<dt><strong>vecb_axes</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.calc_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.calc_eigensystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_eigensystem</span></code></a>()</p></td>
<td><p>Calculates eigenvalues, normalized left and right eigenvectors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.calc_result" title="libics.tools.math.tensor.DiagonalizableLS.calc_result"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_result</span></code></a>([decomp_vec])</p></td>
<td><p>Calculates the result vector <span class="math notranslate nohighlight">\(y\)</span> from a decomposition vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.calc_solution" title="libics.tools.math.tensor.DiagonalizableLS.calc_solution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_solution</span></code></a>([decomp_vec])</p></td>
<td><p>Calculates the solution vector <span class="math notranslate nohighlight">\(x\)</span> from a decomposition vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.decomp_result" title="libics.tools.math.tensor.DiagonalizableLS.decomp_result"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomp_result</span></code></a>([res_vec])</p></td>
<td><p>Decomposes a result vector <span class="math notranslate nohighlight">\(y\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.decomp_solution" title="libics.tools.math.tensor.DiagonalizableLS.decomp_solution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomp_solution</span></code></a>([sol_vec])</p></td>
<td><p>Decomposes a solution vector <span class="math notranslate nohighlight">\(x\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>([sol_vec])</p></td>
<td><p>For a given solution vector <span class="math notranslate nohighlight">\(x\)</span>, directly evaluates the result vector <span class="math notranslate nohighlight">\(y\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ortho_eigensystem</span></code></a>()</p></td>
<td><p>Orthonormalizes the eigenvectors.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve</span></code>([res_vec, algorithm])</p></td>
<td><p>For a given result vector <span class="math notranslate nohighlight">\(y\)</span>, directly solves for the solution vector <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort_eigensystem</span></code></a>([order])</p></td>
<td><p>Sorts the eigensystem according to the given order.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.calc_eigensystem">
<span class="sig-name descname"><span class="pre">calc_eigensystem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.calc_eigensystem" title="Permalink to this definition"></a></dt>
<dd><p>Calculates eigenvalues, normalized left and right eigenvectors.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The eigenvalues are in no guaranteed order.
See <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_eigensystem()</span></code></a>.</p></li>
<li><p>The eigenvectors are not necessarily orthogonal.
See <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem" title="libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ortho_eigensystem()</span></code></a>.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.calc_result">
<span class="sig-name descname"><span class="pre">calc_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decomp_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.calc_result" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the result vector <span class="math notranslate nohighlight">\(y\)</span> from a decomposition vector
<span class="math notranslate nohighlight">\(b\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.calc_solution">
<span class="sig-name descname"><span class="pre">calc_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decomp_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.calc_solution" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the solution vector <span class="math notranslate nohighlight">\(x\)</span> from a decomposition vector
<span class="math notranslate nohighlight">\(b\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.decomp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decomp</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.decomp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.decomp_result">
<span class="sig-name descname"><span class="pre">decomp_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.decomp_result" title="Permalink to this definition"></a></dt>
<dd><p>Decomposes a result vector <span class="math notranslate nohighlight">\(y\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.decomp_solution">
<span class="sig-name descname"><span class="pre">decomp_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sol_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.decomp_solution" title="Permalink to this definition"></a></dt>
<dd><p>Decomposes a solution vector <span class="math notranslate nohighlight">\(x\)</span> into an overlap vector
<span class="math notranslate nohighlight">\(b\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.eigvals">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eigvals</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.eigvals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.eigvecs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eigvecs</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.eigvecs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.is_defective">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_defective</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.is_defective" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.is_diagonalizable">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_diagonalizable</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.is_diagonalizable" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.is_invertible">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_invertible</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.is_invertible" title="Permalink to this definition"></a></dt>
<dd><p>Checks the rank of the matrix. Can be computationally expensive!</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.is_singular">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_singular</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.is_singular" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.leigvecs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">leigvecs</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.leigvecs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">matrix</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem">
<span class="sig-name descname"><span class="pre">ortho_eigensystem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.ortho_eigensystem" title="Permalink to this definition"></a></dt>
<dd><p>Orthonormalizes the eigenvectors.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.reigvecs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reigvecs</span></span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.reigvecs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem">
<span class="sig-name descname"><span class="pre">sort_eigensystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.DiagonalizableLS.sort_eigensystem" title="Permalink to this definition"></a></dt>
<dd><p>Sorts the eigensystem according to the given order.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>order</strong><span class="classifier"><cite>np.ndarray</cite> or <cite>callable</cite> or <cite>None</cite></span></dt><dd><dl class="simple">
<dt><cite>np.ndarray</cite>:</dt><dd><p>Index order defined by this array.
Dimensions: [n_dof].</p>
</dd>
<dt><cite>callable</cite>:</dt><dd><p>Eigenvalue measurement function whose ascendingly sorted
return value defines the index order.
Call signature: <cite>func(np.ndarray(…, n_dof))-&gt;float</cite>.</p>
</dd>
<dt><cite>None</cite>:</dt><dd><p>Index order ascending in modulus of eigenvalue.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.tensor.HermitianLS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">HermitianLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.HermitianLS" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS" title="libics.tools.math.tensor.DiagonalizableLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.tensor.DiagonalizableLS</span></code></a></p>
<p>Eigensystem solver for Hermitian diagonalizable matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>decomp</strong></dt><dd></dd>
<dt><strong>eigvals</strong></dt><dd></dd>
<dt><strong>eigvecs</strong></dt><dd></dd>
<dt><strong>is_defective</strong></dt><dd></dd>
<dt><strong>is_diagonalizable</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_invertible</span></code></dt><dd><p>Checks the rank of the matrix.</p>
</dd>
<dt><strong>is_singular</strong></dt><dd></dd>
<dt><strong>leigvecs</strong></dt><dd></dd>
<dt><strong>mata_axes</strong></dt><dd></dd>
<dt><strong>matb_axes</strong></dt><dd></dd>
<dt><strong>matrix</strong></dt><dd></dd>
<dt><strong>reigvecs</strong></dt><dd></dd>
<dt><strong>result</strong></dt><dd></dd>
<dt><strong>solution</strong></dt><dd></dd>
<dt><strong>vec_axes</strong></dt><dd></dd>
<dt><strong>veca_axes</strong></dt><dd></dd>
<dt><strong>vecb_axes</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.HermitianLS.calc_eigensystem" title="libics.tools.math.tensor.HermitianLS.calc_eigensystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_eigensystem</span></code></a>()</p></td>
<td><p>Calculates eigenvalues, normalized left and right eigenvectors.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_result</span></code>([decomp_vec])</p></td>
<td><p>Calculates the result vector <span class="math notranslate nohighlight">\(y\)</span> from a decomposition vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_solution</span></code>([decomp_vec])</p></td>
<td><p>Calculates the solution vector <span class="math notranslate nohighlight">\(x\)</span> from a decomposition vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomp_result</span></code>([res_vec])</p></td>
<td><p>Decomposes a result vector <span class="math notranslate nohighlight">\(y\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomp_solution</span></code>([sol_vec])</p></td>
<td><p>Decomposes a solution vector <span class="math notranslate nohighlight">\(x\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>([sol_vec])</p></td>
<td><p>For a given solution vector <span class="math notranslate nohighlight">\(x\)</span>, directly evaluates the result vector <span class="math notranslate nohighlight">\(y\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ortho_eigensystem</span></code>()</p></td>
<td><p>Orthonormalizes the eigenvectors.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve</span></code>([res_vec, algorithm])</p></td>
<td><p>For a given result vector <span class="math notranslate nohighlight">\(y\)</span>, directly solves for the solution vector <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort_eigensystem</span></code>([order])</p></td>
<td><p>Sorts the eigensystem according to the given order.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.HermitianLS.calc_eigensystem">
<span class="sig-name descname"><span class="pre">calc_eigensystem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.HermitianLS.calc_eigensystem" title="Permalink to this definition"></a></dt>
<dd><p>Calculates eigenvalues, normalized left and right eigenvectors.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The eigenvalues are in no guaranteed order.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_eigensystem()</span></code>.</p></li>
<li><p>The eigenvectors are not necessarily orthogonal.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">ortho_eigensystem()</span></code>.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">LinearSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mata_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matb_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veca_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vecb_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Linear system solver for arbitrary complex matrices.</p>
<p>The linear system is defined as</p>
<div class="math notranslate nohighlight">
\[M x = y,\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the matrix, <span class="math notranslate nohighlight">\(x\)</span> is the solution vector, and
<span class="math notranslate nohighlight">\(y\)</span> is the result vector.</p>
<p>For a given matrix <span class="math notranslate nohighlight">\(M\)</span> and solution vector <span class="math notranslate nohighlight">\(x\)</span>, this class
supports evaluation of <span class="math notranslate nohighlight">\(y\)</span>. If <span class="math notranslate nohighlight">\(y\)</span> is given, the system
supports direct solving for <span class="math notranslate nohighlight">\(x\)</span>. The matrix and vector dimensions
can consist of multiple indices which are automatically linearized.
For an eigensystem solver, refer to <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS" title="libics.tools.math.tensor.DiagonalizableLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagonalizableLS</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>matrix</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Possibly high rank tensor representable as diagonalizable
matrix, defining a linear system. There must be two sets of
dimensions which can be reshaped as square matrix. The remaining
dimensions will be broadcasted.</p>
</dd>
<dt><strong>mata_axes, matb_axes, veca_axes, veca_bxes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Axes representing the multidimensional indices of the matrix.
<span class="math notranslate nohighlight">\(M = M_{\{a_1, ...\}, \{b_1, ...\}}, x, y = x, y_{\{v_1, ...\}}\)</span>.
<span class="math notranslate nohighlight">\(M x = y = \sum_b M_{a, b} x_b = y_a\)</span>.
The shape of each dimension must be identical and the total number
defines the degrees of freedom <span class="math notranslate nohighlight">\(n_{\text{dof}} = \prod_i n_i\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mata_axes</strong></dt><dd></dd>
<dt><strong>matb_axes</strong></dt><dd></dd>
<dt><strong>matrix</strong></dt><dd></dd>
<dt><strong>result</strong></dt><dd></dd>
<dt><strong>solution</strong></dt><dd></dd>
<dt><strong>vec_axes</strong></dt><dd></dd>
<dt><strong>veca_axes</strong></dt><dd></dd>
<dt><strong>vecb_axes</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.LinearSystem.eval" title="libics.tools.math.tensor.LinearSystem.eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code></a>([sol_vec])</p></td>
<td><p>For a given solution vector <span class="math notranslate nohighlight">\(x\)</span>, directly evaluates the result vector <span class="math notranslate nohighlight">\(y\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#libics.tools.math.tensor.LinearSystem.solve" title="libics.tools.math.tensor.LinearSystem.solve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve</span></code></a>([res_vec, algorithm])</p></td>
<td><p>For a given result vector <span class="math notranslate nohighlight">\(y\)</span>, directly solves for the solution vector <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sol_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.eval" title="Permalink to this definition"></a></dt>
<dd><p>For a given solution vector <span class="math notranslate nohighlight">\(x\)</span>, directly evaluates the result
vector <span class="math notranslate nohighlight">\(y\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.mata_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mata_axes</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.mata_axes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.matb_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">matb_axes</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.matb_axes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">matrix</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.result">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">result</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.result" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.solution">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solution</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.solution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.solve" title="Permalink to this definition"></a></dt>
<dd><p>For a given result vector <span class="math notranslate nohighlight">\(y\)</span>, directly solves for the solution
vector <span class="math notranslate nohighlight">\(x\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.vec_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vec_axes</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.vec_axes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.veca_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">veca_axes</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.veca_axes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="libics.tools.math.tensor.LinearSystem.vecb_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vecb_axes</span></span><a class="headerlink" href="#libics.tools.math.tensor.LinearSystem.vecb_axes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="libics.tools.math.tensor.SymmetricLS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">SymmetricLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.SymmetricLS" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#libics.tools.math.tensor.DiagonalizableLS" title="libics.tools.math.tensor.DiagonalizableLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">libics.tools.math.tensor.DiagonalizableLS</span></code></a></p>
<p>Eigensystem solver for complex symmetric diagonalizable matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>decomp</strong></dt><dd></dd>
<dt><strong>eigvals</strong></dt><dd></dd>
<dt><strong>eigvecs</strong></dt><dd></dd>
<dt><strong>is_defective</strong></dt><dd></dd>
<dt><strong>is_diagonalizable</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_invertible</span></code></dt><dd><p>Checks the rank of the matrix.</p>
</dd>
<dt><strong>is_singular</strong></dt><dd></dd>
<dt><strong>leigvecs</strong></dt><dd></dd>
<dt><strong>mata_axes</strong></dt><dd></dd>
<dt><strong>matb_axes</strong></dt><dd></dd>
<dt><strong>matrix</strong></dt><dd></dd>
<dt><strong>reigvecs</strong></dt><dd></dd>
<dt><strong>result</strong></dt><dd></dd>
<dt><strong>solution</strong></dt><dd></dd>
<dt><strong>vec_axes</strong></dt><dd></dd>
<dt><strong>veca_axes</strong></dt><dd></dd>
<dt><strong>vecb_axes</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#libics.tools.math.tensor.SymmetricLS.calc_eigensystem" title="libics.tools.math.tensor.SymmetricLS.calc_eigensystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_eigensystem</span></code></a>()</p></td>
<td><p>Calculates eigenvalues, normalized left and right eigenvectors.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_result</span></code>([decomp_vec])</p></td>
<td><p>Calculates the result vector <span class="math notranslate nohighlight">\(y\)</span> from a decomposition vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_solution</span></code>([decomp_vec])</p></td>
<td><p>Calculates the solution vector <span class="math notranslate nohighlight">\(x\)</span> from a decomposition vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomp_result</span></code>([res_vec])</p></td>
<td><p>Decomposes a result vector <span class="math notranslate nohighlight">\(y\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomp_solution</span></code>([sol_vec])</p></td>
<td><p>Decomposes a solution vector <span class="math notranslate nohighlight">\(x\)</span> into an overlap vector <span class="math notranslate nohighlight">\(b\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>([sol_vec])</p></td>
<td><p>For a given solution vector <span class="math notranslate nohighlight">\(x\)</span>, directly evaluates the result vector <span class="math notranslate nohighlight">\(y\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ortho_eigensystem</span></code>()</p></td>
<td><p>Orthonormalizes the eigenvectors.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve</span></code>([res_vec, algorithm])</p></td>
<td><p>For a given result vector <span class="math notranslate nohighlight">\(y\)</span>, directly solves for the solution vector <span class="math notranslate nohighlight">\(x\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort_eigensystem</span></code>([order])</p></td>
<td><p>Sorts the eigensystem according to the given order.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="libics.tools.math.tensor.SymmetricLS.calc_eigensystem">
<span class="sig-name descname"><span class="pre">calc_eigensystem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.SymmetricLS.calc_eigensystem" title="Permalink to this definition"></a></dt>
<dd><p>Calculates eigenvalues, normalized left and right eigenvectors.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The eigenvalues are in no guaranteed order.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_eigensystem()</span></code>.</p></li>
<li><p>The eigenvectors are not necessarily orthogonal.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">ortho_eigensystem()</span></code>.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.calc_op_outer">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">calc_op_outer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.calc_op_outer" title="Permalink to this definition"></a></dt>
<dd><p>Perform elementwise operation with broadcasting.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar1, ar2</strong><span class="classifier"><cite>Array</cite></span></dt><dd><p>Arrays as first and second operators with dimensions:
<cite>[{non_ar1/2_dims}, {red_dims}]</cite>.</p>
</dd>
<dt><strong>op</strong><span class="classifier"><cite>str</cite> or <cite>callable</cite></span></dt><dd><p>Binary operator as function or from <code class="xref py py-attr docutils literal notranslate"><span class="pre">BINARY_OPS_NUMPY</span></code>.</p>
</dd>
<dt><strong>reduce_ndim</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Number of dimensions (from the last axis) to perform the operation
elementwise. Other dimensions are broadcasted by outer product.</p>
</dd>
<dt><strong>ret_dims</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Flag whether to return the number of non-positional
dimensions of the vectors <cite>ar1</cite> and <cite>ar2</cite>.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier"><cite>type</cite></span></dt><dd><p>Numpy dtype of return value.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>Array</cite></span></dt><dd><p>Reduced operator result with dimensions:
<cite>[{non_ar1_dims}, {non_ar2_dims}, {red_dims}]</cite>.</p>
</dd>
<dt><strong>non_ar1_dims, non_ar2_dims</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Number of non-reduced dimensions of respective axes.
Only returned if <cite>ret_dims is True</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.complex_norm">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">complex_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.complex_norm" title="Permalink to this definition"></a></dt>
<dd><p>Computes the pseudonorm <span class="math notranslate nohighlight">\(\sqrt{x^T x}\)</span> on the complex (tensorial)
vector <span class="math notranslate nohighlight">\(x\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Array constituting the vector to be normalized.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Tensorial indices corresponding to the vectorial dimensions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>norm</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Resulting norm with removed vectorial axes.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.euclid_norm">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">euclid_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.euclid_norm" title="Permalink to this definition"></a></dt>
<dd><p>Computes the Euclidean norm <span class="math notranslate nohighlight">\(\sqrt{x^\dagger x}\)</span> on the complex
(tensorial) vector <span class="math notranslate nohighlight">\(x\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Array constituting the vector to be normalized.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Tensorial indices corresponding to the vectorial dimensions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>norm</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Resulting norm with removed vectorial axes.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.extract_diag">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">extract_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensorized_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.extract_diag" title="Permalink to this definition"></a></dt>
<dd><p>Extracts a diagonal tensor.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>tensorized_matrix</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>“Matrix” with dimensions: <cite>[{vec_dims}, {vec_dims}]</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>tensorized_vector</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>“Vector” with dimensions: <cite>[{vec_dims}]</cite>.
Contains the multi-dimensional diagonal elements of
<cite>tensorized_matrix</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Inverse operation of <a class="reference internal" href="#libics.tools.math.tensor.make_diag" title="libics.tools.math.tensor.make_diag"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_diag()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.get_dirac_delta">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">get_dirac_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abab'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.get_dirac_delta" title="Permalink to this definition"></a></dt>
<dd><p>Gets a multi-dimensional Dirac delta tensor.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*shape</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Entries per dimension.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier"><cite>np.dtype</cite></span></dt><dd><p>Data type of generated array.</p>
</dd>
<dt><strong>order</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>Dimensional order of Dirac delta.
<cite>“abab”</cite>, <cite>“aabb”</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>dirac_delta</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Multi-dimensional Dirac delta tensor.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.insert_dims">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">insert_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.insert_dims" title="Permalink to this definition"></a></dt>
<dd><p>Expands the dimensions of an array.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Array to be expanded.</p>
</dd>
<dt><strong>ndim</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Number of dimensions to be inserted.</p>
</dd>
<dt><strong>axis</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Dimensional index of insertion.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insert_dims</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 3, 1, 1, 1, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.make_diag">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">make_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensorized_vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.make_diag" title="Permalink to this definition"></a></dt>
<dd><p>Creates a diagonal tensor.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>tensorized_vector</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>“Vector” with dimensions: <cite>[{vec_dims}]</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>tensorized_matrix</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Diagonal “matrix” with dimensions: <cite>[{vec_dims}, {vec_dims}]</cite>.
Contains the <cite>tensorized_vector</cite> elements on its diagonal.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Inverse operation of <a class="reference internal" href="#libics.tools.math.tensor.extract_diag" title="libics.tools.math.tensor.extract_diag"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_diag()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.ortho_gram_schmidt">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">ortho_gram_schmidt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_func=&lt;function</span> <span class="pre">norm&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.ortho_gram_schmidt" title="Permalink to this definition"></a></dt>
<dd><p>Naive Gram-Schmidt orthogonalization.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>vectors</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Normalized, linearly independent row vectors to be orthonormalized.
Dimensions: [n_vector, n_components].</p>
</dd>
<dt><strong>norm</strong><span class="classifier"><cite>callable</cite></span></dt><dd><p>Function computing a vector norm.
Call signature: <cite>norm_func(vector)-&gt;scalar</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>basis</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Orthonormal basis of space spanned by <cite>vectors</cite>.
Dimensions: [n_vector, n_components].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.tensorinv_numpy_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">tensorinv_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.tensorinv_numpy_array" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the tensor inverse (w.r.t. to <a class="reference internal" href="#libics.tools.math.tensor.tensormul_numpy_array" title="libics.tools.math.tensor.tensormul_numpy_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">tensormul_numpy_array()</span></code></a>).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Full tensor.</p>
</dd>
<dt><strong>a_axes, b_axes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Corresponding dimensions to be inverted.
These specified dimensions span an effective square matrix.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Inverted full tensor.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.tensorize_numpy_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">tensorize_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">2,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.tensorize_numpy_array" title="Permalink to this definition"></a></dt>
<dd><p>Tensorizes a vectorized <cite>numpy</cite> array. Opposite of
<a class="reference internal" href="#libics.tools.math.tensor.vectorize_numpy_array" title="libics.tools.math.tensor.vectorize_numpy_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">vectorize_numpy_array()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>vec</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Vector array.</p>
</dd>
<dt><strong>tensor_shape</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Shape of tensorized dimensions.</p>
</dd>
<dt><strong>tensor_axes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Tensor axes of resulting array. Tensorization is performed
in C-like order.</p>
</dd>
<dt><strong>vec_axis</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Dimension of vector array to be tensorized.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Tensor array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.tensormul_numpy_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">tensormul_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(Ellipsis,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">Ellipsis)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(Ellipsis,)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.tensormul_numpy_array" title="Permalink to this definition"></a></dt>
<dd><p>Einstein-sums two <cite>numpy</cite> tensors.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>a, b</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Tensor operands.</p>
</dd>
<dt><strong>a_axes, b_axes, res_axes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Indices of Einstein summation. Dimensions are interpreted
relative. Allows for use of ellipses.
<cite>res_axes</cite> allows for <cite>None</cite> to obtain a scalar.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>res</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Combined result tensor.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function wraps <cite>numpy.einsum</cite>.</p>
<p class="rubric">Examples</p>
<p>Denote: (a_axes), (b_axes) -&gt; (res_axes) [<cite>np.einsum</cite> string]</p>
<ul class="simple">
<li><p>Matrix multiplication: e.g.
(0, 1), (1, 2) -&gt; (0, 2) [“ij,jk-&gt;ik”].</p></li>
<li><p>Tensor dot: e.g.
(0, 1, 2, 3), (4, 2, 3, 5) -&gt; (0, 1, 4, 5) [“ijkl,mjkn-&gt;ilmn”].</p></li>
<li><p>Tensor dot with broadcasting: e.g.
(0, 1, 2, 3), (0, 1, 2, 3) -&gt; (0, 3) [“ijkl,ijkl-&gt;il”].</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.tensorsolve_numpy_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">tensorsolve_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.tensorsolve_numpy_array" title="Permalink to this definition"></a></dt>
<dd><p>Solves a tensor equation <span class="math notranslate nohighlight">\(A x = b\)</span> for <span class="math notranslate nohighlight">\(x\)</span>, where all operands
may be high-dimensional.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Matrix tensor <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
<dt><strong>res</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Vector tensor <span class="math notranslate nohighlight">\(b\)</span>.</p>
</dd>
<dt><strong>a_axes, b_axes, res_axes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Tensorial indices corresponding to
<span class="math notranslate nohighlight">\(\sum_{b} A_{ab} x_b = y_{res}\)</span>.</p>
</dd>
<dt><strong>algorithm</strong><span class="classifier"><cite>None</cite> or <cite>str</cite></span></dt><dd><p><cite>None</cite> or <cite>“lu_fac”</cite>: LU factorization.
<cite>“lst_sq”</cite>: least squares optimization.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>sol</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Solution vector tensor <span class="math notranslate nohighlight">\(x\)</span> with solution indices res_axes.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Tries to solve the linear equation using a deterministic full-rank solver.
If this fails, a least-squares algorithm is used. The least-squares solver
does not support broadcasting.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.tensortranspose_numpy_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">tensortranspose_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.tensortranspose_numpy_array" title="Permalink to this definition"></a></dt>
<dd><p>Transposes the matrix spanned by <cite>a_axes</cite>, <cite>b_axes</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Full tensor.</p>
</dd>
<dt><strong>a_axes, b_axes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Corresponding dimensions to be transposed.
These specified dimensions span an effective square matrix.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Transposed full tensor.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="libics.tools.math.tensor.vectorize_numpy_array">
<span class="sig-prename descclassname"><span class="pre">libics.tools.math.tensor.</span></span><span class="sig-name descname"><span class="pre">vectorize_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">2,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#libics.tools.math.tensor.vectorize_numpy_array" title="Permalink to this definition"></a></dt>
<dd><p>Vectorizes a tensor (high-dimensional) <cite>numpy</cite> array. Opposite of
<a class="reference internal" href="#libics.tools.math.tensor.tensorize_numpy_array" title="libics.tools.math.tensor.tensorize_numpy_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">tensorize_numpy_array()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ar</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Tensor array.</p>
</dd>
<dt><strong>tensor_axes</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>Tensor axes to be vectorized. Vectorization is performed
in C-like order.</p>
</dd>
<dt><strong>vec_axis</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>Vectorized dimension of resulting vector array.</p>
</dd>
<dt><strong>ret_shape</strong><span class="classifier"><cite>bool</cite></span></dt><dd><p>Flag whether to return the shape of the vectorized dimensions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>vec</strong><span class="classifier"><cite>np.ndarray</cite></span></dt><dd><p>Vector array.</p>
</dd>
<dt><strong>vec_shape</strong><span class="classifier"><cite>tuple(int)</cite></span></dt><dd><p>If ret_shape is set: shape of vectorized dimensions.
Useful as parameter for tensorization.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Performance is maximal for back-aligned, ordered vectorization since
in-place data ordering is possible.</p>
<p class="rubric">Examples</p>
<p>Given a tensor A[i, j, k, l], required is a vectorized version
A[i, j*k, l]. The corresponding call would be:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 3, 4, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">vectorize_numpy_array</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">tensor_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">vec_axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 12, 5)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="libics.tools.database.html" class="btn btn-neutral float-left" title="libics.tools.database" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="libics.tools.plot.html" class="btn btn-neutral float-right" title="libics.tools.plot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, David Wei.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>